
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Hw5}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}206}]:} \PY{k+kn}{import} \PY{n+nn}{warnings}
          \PY{n}{warnings}\PY{o}{.}\PY{n}{filterwarnings}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
          \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
          \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{CountVectorizer}\PY{p}{,}\PY{n}{TfidfVectorizer}\PY{p}{,} \PY{n}{TfidfTransformer}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LogisticRegression}\PY{p}{,} \PY{n}{LogisticRegressionCV}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{make\PYZus{}pipeline}\PY{p}{,} \PY{n}{Pipeline}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{Normalizer} 
          
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{f1\PYZus{}score} \PY{p}{,}\PY{n}{average\PYZus{}precision\PYZus{}score} \PY{p}{,}\PY{n}{roc\PYZus{}auc\PYZus{}score}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \subsection{Task 1 Title and Body
(30Pts)}\label{task-1-title-and-body-30pts}

Use CountVectorizer with the default settings and train a linear
classifier. Visualize the 20 most important features in the linear
model. Tune the regularization parameter of the classifier, and
visualize the 20 most important features after regularization. Do this
for all 4 settings. Which one works best? For the simplicity, for the
remaining tasks, we will work with option 3), concatenating the texts.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}212}]:} \PY{n}{train\PYZus{}main} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hw5\PYZus{}data\PYZus{}train.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{test\PYZus{}main} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hw5\PYZus{}data\PYZus{}test.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}213}]:} \PY{n}{train}\PY{p}{,} \PY{n}{test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{train\PYZus{}main}\PY{p}{,}\PY{n}{train\PYZus{}main}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recommended}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{p}{,} \PY{n}{stratify} \PY{o}{=}  \PY{n}{train\PYZus{}main}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recommended}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}216}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{train = }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train}\PY{o}{.}\PY{n}{shape}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{test = }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
train =  (13210, 3) 
test =  (4404, 3)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}217}]:} \PY{n}{train}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}217}]:}                               Title  \textbackslash{}
          14278  Beautiful sweater, but pills   
          7912                     Looooove!!   
          5783             A lovely basic top   
          14539        Pretty dress, poor fit   
          2704                     Beautiful!   
          
                                                            Review  Recommended  
          14278  I love the look of this sweater and was so hap{\ldots}            0  
          7912   I normally don't write reviews for clothing bu{\ldots}            1  
          5783   I'm between sizes in deletta (m to l, 5'4", 34{\ldots}            1  
          14539  I really wanted to love this dress, but it jus{\ldots}            0  
          2704   I wore this dress to a july wedding in miami b{\ldots}            1  
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}218}]:} \PY{n}{test}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}218}]:}                        Title  \textbackslash{}
          8234          Fits perfectly   
          7811       Comfy and stylish   
          13470                  Nope!   
          2745   Wish i could keep it!   
          2603              Super cute   
          
                                                            Review  Recommended  
          8234   I'm small--5'1" and 90 lbs--and the petite xxs{\ldots}            1  
          7811   I love this vest and could not leave without i{\ldots}            1  
          13470  Weird fit and the tie just add to the problems{\ldots}            0  
          2745   So this dress is absolutely gorgeous! my probl{\ldots}            1  
          2603   Super cute and flow. mine had a bit of stitchi{\ldots}            1  
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}220}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[0 1]
[1 0]

    \end{Verbatim}

    \paragraph{1) Use the title only}\label{use-the-title-only}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}282}]:} \PY{n}{train1\PYZus{}clean} \PY{o}{=} \PY{n}{train}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{thresh}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{test1\PYZus{}clean} \PY{o}{=} \PY{n}{test}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{thresh}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          
          \PY{n}{test\PYZus{}main\PYZus{}clean} \PY{o}{=} \PY{n}{test\PYZus{}main}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{thresh}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{train1\PYZus{}clean}\PY{o}{.}\PY{n}{shape}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test1\PYZus{}clean}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
(11088, 2) 
 (3674, 2)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}222}]:} \PY{n}{train1\PYZus{}clean}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}222}]:}                           Title  Recommended
          0  Beautiful sweater, but pills            0
          1                    Looooove!!            1
          2            A lovely basic top            1
          3        Pretty dress, poor fit            0
          4                    Beautiful!            1
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}223}]:} \PY{c+c1}{\PYZsh{}default params}
          \PY{n}{vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}
          \PY{n}{X\PYZus{}train1} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train1\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train1} \PY{o}{=} \PY{n}{train1\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test1} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test1\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test1} \PY{o}{=} \PY{n}{test1\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names1} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg1} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg1}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train1}\PY{p}{,}\PY{n}{y\PYZus{}train1}\PY{p}{)}
          \PY{n}{logreg1}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test1}\PY{p}{,}\PY{n}{y\PYZus{}test1}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}223}]:} 0.8889493739793141
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}224}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg1}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test1}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test1}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg1}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test1}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test1}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg1}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test1}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test1}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9564875099151535
Test F1 score:  0.9342571704801805
Test ROC AUC score:  0.8421410925134545

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}225}]:} \PY{n}{logreg1}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}225}]:} array([0.27596701, 0.16014591, 0.01771065, {\ldots}, 0.21856947, 0.27167001,
                 0.20306462])
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}228}]:} \PY{n}{colour} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{40}\PY{p}{)}\PY{p}{:}
              \PY{k}{if} \PY{n}{i} \PY{o}{\PYZlt{}} \PY{l+m+mi}{20}\PY{p}{:}
                  \PY{n}{colour}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{red}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
              \PY{k}{else}\PY{p}{:}
                  \PY{n}{colour}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{k}{def} \PY{n+nf}{plot}\PY{p}{(}\PY{n}{coef}\PY{p}{,}\PY{n}{feature\PYZus{}names}\PY{p}{,}\PY{n}{i}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}plots top 20 features}
              \PY{n}{top20\PYZus{}index\PYZus{}pos} \PY{o}{=} \PY{n}{coef}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{:}\PY{p}{]} \PY{c+c1}{\PYZsh{}top 20 coefficient index values from logreg.coef\PYZus{} array}
              \PY{n}{top20\PYZus{}pos} \PY{o}{=} \PY{n}{coef}\PY{p}{[}\PY{n}{top20\PYZus{}index\PYZus{}pos}\PY{p}{]}
              \PY{n+nb}{print} \PY{p}{(}\PY{n}{top20\PYZus{}pos}\PY{p}{)}
              \PY{n}{top20\PYZus{}names\PYZus{}pos} \PY{o}{=} \PY{p}{[}\PY{n}{feature\PYZus{}names}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n}{top20\PYZus{}index\PYZus{}pos}\PY{p}{]} \PY{c+c1}{\PYZsh{}gets top20 words from feature names}
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{top20\PYZus{}names\PYZus{}pos}\PY{p}{)}
              \PY{n}{top20\PYZus{}index\PYZus{}neg} \PY{o}{=} \PY{n}{coef}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{20}\PY{p}{]} \PY{c+c1}{\PYZsh{}top 20 coefficient index values from logreg.coef\PYZus{} array}
              \PY{n}{top20\PYZus{}neg} \PY{o}{=} \PY{n}{coef}\PY{p}{[}\PY{n}{top20\PYZus{}index\PYZus{}neg}\PY{p}{]}
              \PY{n+nb}{print} \PY{p}{(}\PY{n}{top20\PYZus{}neg}\PY{p}{)}
              \PY{n}{top20\PYZus{}names\PYZus{}neg} \PY{o}{=} \PY{p}{[}\PY{n}{feature\PYZus{}names}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n}{top20\PYZus{}index\PYZus{}neg}\PY{p}{]} \PY{c+c1}{\PYZsh{}gets top20 words from feature names}
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{top20\PYZus{}names\PYZus{}neg}\PY{p}{)}
              \PY{n}{top\PYZus{}coef} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{[}\PY{n}{top20\PYZus{}neg}\PY{p}{,}\PY{n}{top20\PYZus{}pos}\PY{p}{]}\PY{p}{)}
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{top\PYZus{}coef}\PY{p}{)}
              \PY{n}{top\PYZus{}names} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{[}\PY{n}{top20\PYZus{}names\PYZus{}neg}\PY{p}{,}\PY{n}{top20\PYZus{}names\PYZus{}pos}\PY{p}{]}\PY{p}{)}
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{top\PYZus{}names}\PY{p}{)}
          
              \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{)}\PY{p}{,}\PY{n}{top\PYZus{}coef}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{n}{colour}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{20 most important features }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{)}\PY{p}{,}\PY{n}{top\PYZus{}names}\PY{p}{,}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}240}]:} \PY{n}{colour} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{40}\PY{p}{)}\PY{p}{:}
              \PY{k}{if} \PY{n}{i} \PY{o}{\PYZlt{}} \PY{l+m+mi}{20}\PY{p}{:}
                  \PY{n}{colour}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{red}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
              \PY{k}{else}\PY{p}{:}
                  \PY{n}{colour}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
              
          \PY{k}{def} \PY{n+nf}{plot}\PY{p}{(}\PY{n}{coef}\PY{p}{,}\PY{n}{feature\PYZus{}names}\PY{p}{,}\PY{n}{i}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}plots top 20 features}
              \PY{n}{top20\PYZus{}index\PYZus{}pos} \PY{o}{=} \PY{n}{coef}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{:}\PY{p}{]} \PY{c+c1}{\PYZsh{}top 20 coefficient index values from logreg.coef\PYZus{} array}
              \PY{n}{top20\PYZus{}pos} \PY{o}{=} \PY{n}{coef}\PY{p}{[}\PY{n}{top20\PYZus{}index\PYZus{}pos}\PY{p}{]}
              \PY{n+nb}{print} \PY{p}{(}\PY{n}{top20\PYZus{}pos}\PY{p}{)}
              \PY{n}{top20\PYZus{}names\PYZus{}pos} \PY{o}{=} \PY{p}{[}\PY{n}{feature\PYZus{}names}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n}{top20\PYZus{}index\PYZus{}pos}\PY{p}{]} \PY{c+c1}{\PYZsh{}gets top20 words from feature names}
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{top20\PYZus{}names\PYZus{}pos}\PY{p}{)}
              \PY{n}{top20\PYZus{}index\PYZus{}neg} \PY{o}{=} \PY{n}{coef}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{20}\PY{p}{]} \PY{c+c1}{\PYZsh{}top 20 coefficient index values from logreg.coef\PYZus{} array}
              \PY{n}{top20\PYZus{}neg} \PY{o}{=} \PY{n}{coef}\PY{p}{[}\PY{n}{top20\PYZus{}index\PYZus{}neg}\PY{p}{]}
              \PY{n+nb}{print} \PY{p}{(}\PY{n}{top20\PYZus{}neg}\PY{p}{)}
              \PY{n}{top20\PYZus{}names\PYZus{}neg} \PY{o}{=} \PY{p}{[}\PY{n}{feature\PYZus{}names}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n}{top20\PYZus{}index\PYZus{}neg}\PY{p}{]} \PY{c+c1}{\PYZsh{}gets top20 words from feature names}
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{top20\PYZus{}names\PYZus{}neg}\PY{p}{)}
              \PY{n}{top\PYZus{}coef} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{[}\PY{n}{top20\PYZus{}neg}\PY{p}{,}\PY{n}{top20\PYZus{}pos}\PY{p}{]}\PY{p}{)}
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{top\PYZus{}coef}\PY{p}{)}
              \PY{n}{top\PYZus{}names} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{[}\PY{n}{top20\PYZus{}names\PYZus{}neg}\PY{p}{,}\PY{n}{top20\PYZus{}names\PYZus{}pos}\PY{p}{]}\PY{p}{)}
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{top\PYZus{}names}\PY{p}{)}
          
              \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{)}\PY{p}{,}\PY{n}{top\PYZus{}coef}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{n}{colour}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{20 most important features }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{)}\PY{p}{,}\PY{n}{top\PYZus{}names}\PY{p}{,}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}229}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg1}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[1.66463256 1.67440413 1.71419128 1.75805566 1.77722984 1.81044084
 1.83124505 1.83219752 1.86497013 1.93376101 2.00758922 2.02198025
 2.06683447 2.17071126 2.20057276 2.21417034 2.22679172 2.24397146
 2.47225981 2.69236594]
['lovely', 'perfection', 'great', 'nice', 'stylish', 'cozy', 'elegant', 'comfy', 'awesome', 'soft', 'little', 'versatile', 'gorgeous', 'love', 'stunning', 'perfect', 'comfortable', 'amazing', 'unique', 'fun']
[-3.9989159  -3.2961309  -3.25396528 -2.8097402  -2.67558442 -2.54559009
 -2.44165471 -2.40508654 -2.32055246 -2.31859306 -2.29101087 -2.22834341
 -2.19625909 -2.17344314 -2.12000815 -2.1179435  -2.08526583 -2.07812922
 -2.07290846 -2.07105653]
['wanted', 'disappointed', 'disappointing', 'unflattering', 'poor', 'horrible', 'not', 'didn', 'cheap', 'shapeless', 'terrible', 'tent', 'awkward', 'strange', 'meh', 'until', 'nothing', 'huge', 'been', 'scratchy']
[-3.9989159  -3.2961309  -3.25396528 -2.8097402  -2.67558442 -2.54559009
 -2.44165471 -2.40508654 -2.32055246 -2.31859306 -2.29101087 -2.22834341
 -2.19625909 -2.17344314 -2.12000815 -2.1179435  -2.08526583 -2.07812922
 -2.07290846 -2.07105653  1.66463256  1.67440413  1.71419128  1.75805566
  1.77722984  1.81044084  1.83124505  1.83219752  1.86497013  1.93376101
  2.00758922  2.02198025  2.06683447  2.17071126  2.20057276  2.21417034
  2.22679172  2.24397146  2.47225981  2.69236594]
['wanted' 'disappointed' 'disappointing' 'unflattering' 'poor' 'horrible'
 'not' 'didn' 'cheap' 'shapeless' 'terrible' 'tent' 'awkward' 'strange'
 'meh' 'until' 'nothing' 'huge' 'been' 'scratchy' 'lovely' 'perfection'
 'great' 'nice' 'stylish' 'cozy' 'elegant' 'comfy' 'awesome' 'soft'
 'little' 'versatile' 'gorgeous' 'love' 'stunning' 'perfect' 'comfortable'
 'amazing' 'unique' 'fun']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}230}]:} \PY{c+c1}{\PYZsh{}with CV}
          \PY{n}{vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}
          \PY{n}{X\PYZus{}train1\PYZus{}cv} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train1\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train1\PYZus{}cv} \PY{o}{=} \PY{n}{train1\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test1\PYZus{}cv} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test1\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test1\PYZus{}cv} \PY{o}{=} \PY{n}{test1\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names1\PYZus{}cv} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg1\PYZus{}cv} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{Cs} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mf}{1.1}\PY{p}{,}\PY{l+m+mf}{1.15}\PY{p}{,}\PY{l+m+mf}{1.2}\PY{p}{,}\PY{l+m+mf}{1.23}\PY{p}{,}\PY{l+m+mf}{1.4}\PY{p}{]}\PY{p}{,}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg1\PYZus{}cv}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train1\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}train1\PYZus{}cv}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg1\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test1\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}test1\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg1\PYZus{}cv}\PY{o}{.}\PY{n}{C\PYZus{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8889493739793141
C: [1.23]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}231}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg1\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test1\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test1\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg1\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test1\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test1\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg1\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test1\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test1\PYZus{}cv}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9551710272803298
Test F1 score:  0.9341723136495644
Test ROC AUC score:  0.840316778891862

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}232}]:} \PY{n}{logreg1\PYZus{}cv}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}232}]:} array([0.34462075, 0.17922977, 0.01750281, {\ldots}, 0.26596794, 0.32177213,
                 0.23960715])
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}233}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg1\PYZus{}cv}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names1\PYZus{}cv}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1\PYZhy{}cv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[1.74352062 1.77249804 1.79521947 1.80256515 1.8893198  1.91567424
 1.93261461 1.98483418 2.00304402 2.01059131 2.12877915 2.14619127
 2.14764808 2.21881955 2.27181736 2.31771738 2.32495123 2.35729232
 2.61895288 2.85236125]
['justice', 'basic', 'perfection', 'nice', 'comfy', 'stylish', 'cozy', 'elegant', 'soft', 'awesome', 'gorgeous', 'little', 'versatile', 'love', 'perfect', 'comfortable', 'stunning', 'amazing', 'unique', 'fun']
[-4.11040095 -3.4213091  -3.41771885 -2.93319747 -2.7947699  -2.77534732
 -2.54866309 -2.52184706 -2.50337964 -2.48922629 -2.46038333 -2.41933928
 -2.30812801 -2.28674925 -2.28441501 -2.27353251 -2.25200404 -2.22403701
 -2.22144981 -2.1987102 ]
['wanted', 'disappointed', 'disappointing', 'unflattering', 'horrible', 'poor', 'didn', 'not', 'shapeless', 'cheap', 'terrible', 'tent', 'awkward', 'until', 'strange', 'nothing', 'been', 'meh', 'scratchy', 'sack']
[-4.11040095 -3.4213091  -3.41771885 -2.93319747 -2.7947699  -2.77534732
 -2.54866309 -2.52184706 -2.50337964 -2.48922629 -2.46038333 -2.41933928
 -2.30812801 -2.28674925 -2.28441501 -2.27353251 -2.25200404 -2.22403701
 -2.22144981 -2.1987102   1.74352062  1.77249804  1.79521947  1.80256515
  1.8893198   1.91567424  1.93261461  1.98483418  2.00304402  2.01059131
  2.12877915  2.14619127  2.14764808  2.21881955  2.27181736  2.31771738
  2.32495123  2.35729232  2.61895288  2.85236125]
['wanted' 'disappointed' 'disappointing' 'unflattering' 'horrible' 'poor'
 'didn' 'not' 'shapeless' 'cheap' 'terrible' 'tent' 'awkward' 'until'
 'strange' 'nothing' 'been' 'meh' 'scratchy' 'sack' 'justice' 'basic'
 'perfection' 'nice' 'comfy' 'stylish' 'cozy' 'elegant' 'soft' 'awesome'
 'gorgeous' 'little' 'versatile' 'love' 'perfect' 'comfortable' 'stunning'
 'amazing' 'unique' 'fun']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_29_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \paragraph{2) Use the review body only}\label{use-the-review-body-only}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}234}]:} \PY{n}{train2\PYZus{}clean} \PY{o}{=} \PY{n}{train}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Review}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{thresh}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{test2\PYZus{}clean} \PY{o}{=} \PY{n}{test}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Review}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{thresh}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{train2\PYZus{}clean}\PY{o}{.}\PY{n}{shape}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test2\PYZus{}clean}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
(12734, 2) 
 (4251, 2)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}235}]:} \PY{n}{train2\PYZus{}clean}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}235}]:}                                               Review  Recommended
          0  I love the look of this sweater and was so hap{\ldots}            0
          1  I normally don't write reviews for clothing bu{\ldots}            1
          2  I'm between sizes in deletta (m to l, 5'4", 34{\ldots}            1
          3  I really wanted to love this dress, but it jus{\ldots}            0
          4  I wore this dress to a july wedding in miami b{\ldots}            1
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}236}]:} \PY{c+c1}{\PYZsh{}default params}
          \PY{n}{vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}
          \PY{n}{X\PYZus{}train2} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train2\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Review}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train2} \PY{o}{=} \PY{n}{train2\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test2} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test2\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Review}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test2} \PY{o}{=} \PY{n}{test2\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names2} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg2} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg2}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train2}\PY{p}{,}\PY{n}{y\PYZus{}train2}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg2}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test2}\PY{p}{,}\PY{n}{y\PYZus{}test2}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8882615855092919

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}237}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg2}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test2}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test2}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg2}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test2}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test2}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg2}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test2}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test2}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9341045965080008
Test F1 score:  0.9324996447349723
Test ROC AUC score:  0.8170661768271983

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}238}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg2}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[1.2393148  1.24229168 1.25202254 1.25734585 1.26059808 1.2671636
 1.27185852 1.31514321 1.3161773  1.3186311  1.33631546 1.34278663
 1.35642357 1.35660737 1.42777173 1.48908307 1.5209158  1.5258742
 1.54369813 1.57857957]
['elegant', 'linen', 'compliments', 'ties', 'adore', 'season', 'caution', 'pleased', 'unique', 'justice', 'sold', '34a', 'helps', 'add', 'midweight', 'dressed', 'beautifully', 'feminine', 'drop', 'stylish']
[-2.25986287 -1.78987905 -1.72961233 -1.68914445 -1.66549184 -1.64404591
 -1.61637488 -1.50511167 -1.4814577  -1.470046   -1.45186148 -1.39687668
 -1.38801472 -1.31011519 -1.30157348 -1.30095187 -1.2968461  -1.27071003
 -1.26682786 -1.26530928]
['awful', 'returned', 'hopes', 'disappointed', 'shame', 'cheap', 'poor', 'inseam', 'itchy', 'frustrating', 'ripped', 'space', 'returning', 'wasted', 'sack', 'weirdly', 'therefore', 'nothing', 'maternity', 'shrank']
[-2.25986287 -1.78987905 -1.72961233 -1.68914445 -1.66549184 -1.64404591
 -1.61637488 -1.50511167 -1.4814577  -1.470046   -1.45186148 -1.39687668
 -1.38801472 -1.31011519 -1.30157348 -1.30095187 -1.2968461  -1.27071003
 -1.26682786 -1.26530928  1.2393148   1.24229168  1.25202254  1.25734585
  1.26059808  1.2671636   1.27185852  1.31514321  1.3161773   1.3186311
  1.33631546  1.34278663  1.35642357  1.35660737  1.42777173  1.48908307
  1.5209158   1.5258742   1.54369813  1.57857957]
['awful' 'returned' 'hopes' 'disappointed' 'shame' 'cheap' 'poor' 'inseam'
 'itchy' 'frustrating' 'ripped' 'space' 'returning' 'wasted' 'sack'
 'weirdly' 'therefore' 'nothing' 'maternity' 'shrank' 'elegant' 'linen'
 'compliments' 'ties' 'adore' 'season' 'caution' 'pleased' 'unique'
 'justice' 'sold' '34a' 'helps' 'add' 'midweight' 'dressed' 'beautifully'
 'feminine' 'drop' 'stylish']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}239}]:} \PY{c+c1}{\PYZsh{}with CV}
          \PY{n}{vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}
          \PY{n}{X\PYZus{}train2\PYZus{}cv} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train2\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Review}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train2\PYZus{}cv} \PY{o}{=} \PY{n}{train2\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test2\PYZus{}cv} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test2\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Review}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test2\PYZus{}cv} \PY{o}{=} \PY{n}{test2\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names2\PYZus{}cv} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg2\PYZus{}cv} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg2\PYZus{}cv}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train2\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}train2\PYZus{}cv}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg2\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test2\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}test2\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg2\PYZus{}cv}\PY{o}{.}\PY{n}{C\PYZus{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8852034815337567
C: [0.04641589]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}241}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg2\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test2\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test2\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg2\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test2\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test2\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg2\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test2\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test2\PYZus{}cv}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9528468646552953
Test F1 score:  0.9320712694877505
Test ROC AUC score:  0.8301479336232371

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}242}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg2\PYZus{}cv}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names2\PYZus{}cv}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2\PYZhy{}cv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[0.39227269 0.39231976 0.39317555 0.4022602  0.42184413 0.43743482
 0.44004033 0.44208536 0.44730537 0.46357951 0.48977441 0.50757709
 0.52239993 0.52681328 0.53163335 0.53510764 0.57205353 0.57338671
 0.7165083  0.7263525 ]
['easy', 'nicely', 'casual', 'amazing', 'details', 'glad', 'recommend', 'happy', 'beautifully', 'feminine', 'fits', 'soft', 'love', 'little', 'great', 'unique', 'perfectly', 'compliments', 'perfect', 'comfortable']
[-0.97049427 -0.8736004  -0.7823568  -0.77052624 -0.75534608 -0.67518825
 -0.6343559  -0.52871938 -0.52363371 -0.51539049 -0.51135659 -0.49137049
 -0.48634917 -0.46613203 -0.45853969 -0.45810765 -0.45193783 -0.45010544
 -0.44118251 -0.4409696 ]
['disappointed', 'returned', 'returning', 'wanted', 'cheap', 'huge', 'unflattering', 'bad', 'poor', 'return', 'awful', 'nothing', 'looked', 'excited', 'itchy', 'thin', 'unfortunately', 'felt', 'sack', 'maternity']
[-0.97049427 -0.8736004  -0.7823568  -0.77052624 -0.75534608 -0.67518825
 -0.6343559  -0.52871938 -0.52363371 -0.51539049 -0.51135659 -0.49137049
 -0.48634917 -0.46613203 -0.45853969 -0.45810765 -0.45193783 -0.45010544
 -0.44118251 -0.4409696   0.39227269  0.39231976  0.39317555  0.4022602
  0.42184413  0.43743482  0.44004033  0.44208536  0.44730537  0.46357951
  0.48977441  0.50757709  0.52239993  0.52681328  0.53163335  0.53510764
  0.57205353  0.57338671  0.7165083   0.7263525 ]
['disappointed' 'returned' 'returning' 'wanted' 'cheap' 'huge'
 'unflattering' 'bad' 'poor' 'return' 'awful' 'nothing' 'looked' 'excited'
 'itchy' 'thin' 'unfortunately' 'felt' 'sack' 'maternity' 'easy' 'nicely'
 'casual' 'amazing' 'details' 'glad' 'recommend' 'happy' 'beautifully'
 'feminine' 'fits' 'soft' 'love' 'little' 'great' 'unique' 'perfectly'
 'compliments' 'perfect' 'comfortable']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_41_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{3) Concatenate the title and review to a single text and
analyze that (discarding the information which words were in the title
and which in the
body)}\label{concatenate-the-title-and-review-to-a-single-text-and-analyze-that-discarding-the-information-which-words-were-in-the-title-and-which-in-the-body}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}243}]:} \PY{n}{train3} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{)}
          \PY{n}{train3}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{train}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Review}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
          \PY{n}{train3}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{train3\PYZus{}clean} \PY{o}{=} \PY{n}{train3}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{thresh}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{train3\PYZus{}clean}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}243}]:}                                                 text  Recommended
          0  Beautiful sweater, but pills I love the look o{\ldots}            0
          1  Looooove!! I normally don't write reviews for {\ldots}            1
          2  A lovely basic top I'm between sizes in delett{\ldots}            1
          3  Pretty dress, poor fit I really wanted to love{\ldots}            0
          4  Beautiful! I wore this dress to a july wedding{\ldots}            1
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}244}]:} \PY{n}{test3} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{)}
          \PY{n}{test3}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{test}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Review}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
          \PY{n}{test3}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{test3\PYZus{}clean} \PY{o}{=} \PY{n}{test3}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{thresh}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{test3\PYZus{}clean}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}244}]:}                                                 text  Recommended
          0  Fits perfectly I'm small--5'1" and 90 lbs--and{\ldots}            1
          1  Comfy and stylish I love this vest and could n{\ldots}            1
          2  Nope! Weird fit and the tie just add to the pr{\ldots}            0
          3  Wish i could keep it! So this dress is absolut{\ldots}            1
          4  Super cute Super cute and flow. mine had a bit{\ldots}            1
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}245}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
(11088, 2)
(3674, 2)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}246}]:} \PY{c+c1}{\PYZsh{}default params}
          \PY{n}{vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}
          \PY{n}{X\PYZus{}train3} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train3} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test3} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test3} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names3} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg3} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg3}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train3}\PY{p}{,}\PY{n}{y\PYZus{}train3}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg3}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test3}\PY{p}{,}\PY{n}{y\PYZus{}test3}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8987479586281981

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}247}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg3}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test3}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test3}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg3}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test3}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test3}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg3}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test3}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test3}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9371516922946084
Test F1 score:  0.9384920634920635
Test ROC AUC score:  0.8348492798797058

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}248}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg3}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[1.12256214 1.13961049 1.1466177  1.19613308 1.21601869 1.22846537
 1.23764544 1.23821301 1.25500414 1.2570197  1.2841668  1.311923
 1.31934487 1.32858872 1.40812575 1.43277772 1.45557793 1.52251214
 1.53183634 1.54330323]
['feminine', 'awesome', 'modern', 'plaid', 'caution', 'factor', 'add', 'dressed', 'elegant', 'compliments', 'test', 'snug', 'amazing', 'beautifully', 'pleased', 'unique', 'honey', 'versatile', 'stylish', 'drop']
[-2.07321059 -1.98627844 -1.79370344 -1.77119123 -1.74060929 -1.70896474
 -1.60067504 -1.52309089 -1.49444797 -1.49102174 -1.47037495 -1.45994296
 -1.44883983 -1.38282882 -1.36940433 -1.34367213 -1.30009994 -1.29115809
 -1.26234493 -1.25688021]
['meh', 'disappointed', 'awful', 'returned', 'disappointing', 'sack', 'shame', 'age', 'cheap', 'wanted', 'shapeless', 'ripped', 'horrible', 'overpriced', 'impossible', 'concept', 'poor', 'itchy', 'additionally', 'drab']
[-2.07321059 -1.98627844 -1.79370344 -1.77119123 -1.74060929 -1.70896474
 -1.60067504 -1.52309089 -1.49444797 -1.49102174 -1.47037495 -1.45994296
 -1.44883983 -1.38282882 -1.36940433 -1.34367213 -1.30009994 -1.29115809
 -1.26234493 -1.25688021  1.12256214  1.13961049  1.1466177   1.19613308
  1.21601869  1.22846537  1.23764544  1.23821301  1.25500414  1.2570197
  1.2841668   1.311923    1.31934487  1.32858872  1.40812575  1.43277772
  1.45557793  1.52251214  1.53183634  1.54330323]
['meh' 'disappointed' 'awful' 'returned' 'disappointing' 'sack' 'shame'
 'age' 'cheap' 'wanted' 'shapeless' 'ripped' 'horrible' 'overpriced'
 'impossible' 'concept' 'poor' 'itchy' 'additionally' 'drab' 'feminine'
 'awesome' 'modern' 'plaid' 'caution' 'factor' 'add' 'dressed' 'elegant'
 'compliments' 'test' 'snug' 'amazing' 'beautifully' 'pleased' 'unique'
 'honey' 'versatile' 'stylish' 'drop']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_48_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}249}]:} \PY{c+c1}{\PYZsh{}with CV}
          \PY{n}{vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}
          \PY{n}{X\PYZus{}train3\PYZus{}cv} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train3\PYZus{}cv} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test3\PYZus{}cv} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test3\PYZus{}cv} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names3\PYZus{}cv} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)} 
          \PY{n}{logreg3\PYZus{}cv} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg3\PYZus{}cv}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train3\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}train3\PYZus{}cv}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg3\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test3\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}test3\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg3\PYZus{}cv}\PY{o}{.}\PY{n}{C\PYZus{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.9009254218835057
C: [0.04641589]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}276}]:} \PY{n}{X\PYZus{}train3\PYZus{}cv}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}276}]:} <11088x11095 sparse matrix of type '<class 'numpy.int64'>'
          	with 503030 stored elements in Compressed Sparse Row format>
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}250}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg3\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test3\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test3\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg3\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test3\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test3\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg3\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test3\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test3\PYZus{}cv}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9541062096841407
Test F1 score:  0.9407744874715261
Test ROC AUC score:  0.854449519543325

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}251}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg3\PYZus{}cv}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names3\PYZus{}cv}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3\PYZhy{}cv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[0.38882906 0.39418194 0.4015464  0.40508181 0.41908435 0.43452645
 0.43527615 0.44807764 0.4553095  0.46329898 0.49910003 0.50196928
 0.50245886 0.51296674 0.53099663 0.54481952 0.57144502 0.64233278
 0.64236304 0.67721892]
['lovely', 'comfy', 'snug', 'saw', 'fun', 'casual', 'feminine', 'versatile', 'nice', 'little', 'soft', 'gorgeous', 'compliments', 'perfectly', 'amazing', 'great', 'love', 'unique', 'comfortable', 'perfect']
[-1.00966378 -0.87745027 -0.78369513 -0.67058447 -0.66835424 -0.66366222
 -0.64172107 -0.63130027 -0.56432058 -0.53874603 -0.49015367 -0.48644914
 -0.47441307 -0.46812074 -0.44773847 -0.44509114 -0.44480412 -0.42951192
 -0.42333524 -0.42331551]
['disappointed', 'wanted', 'returned', 'cheap', 'huge', 'unflattering', 'poor', 'returning', 'disappointing', 'strange', 'sack', 'nothing', 'return', 'bad', 'tent', 'itchy', 'unfortunately', 'meh', 'shapeless', 'looked']
[-1.00966378 -0.87745027 -0.78369513 -0.67058447 -0.66835424 -0.66366222
 -0.64172107 -0.63130027 -0.56432058 -0.53874603 -0.49015367 -0.48644914
 -0.47441307 -0.46812074 -0.44773847 -0.44509114 -0.44480412 -0.42951192
 -0.42333524 -0.42331551  0.38882906  0.39418194  0.4015464   0.40508181
  0.41908435  0.43452645  0.43527615  0.44807764  0.4553095   0.46329898
  0.49910003  0.50196928  0.50245886  0.51296674  0.53099663  0.54481952
  0.57144502  0.64233278  0.64236304  0.67721892]
['disappointed' 'wanted' 'returned' 'cheap' 'huge' 'unflattering' 'poor'
 'returning' 'disappointing' 'strange' 'sack' 'nothing' 'return' 'bad'
 'tent' 'itchy' 'unfortunately' 'meh' 'shapeless' 'looked' 'lovely'
 'comfy' 'snug' 'saw' 'fun' 'casual' 'feminine' 'versatile' 'nice'
 'little' 'soft' 'gorgeous' 'compliments' 'perfectly' 'amazing' 'great'
 'love' 'unique' 'comfortable' 'perfect']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_52_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{4) Vectorizing title and review individually and
concatenating the vector
representations.}\label{vectorizing-title-and-review-individually-and-concatenating-the-vector-representations.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}252}]:} \PY{n}{train4\PYZus{}clean} \PY{o}{=} \PY{n}{train}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Review}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{thresh}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{test4\PYZus{}clean} \PY{o}{=} \PY{n}{test}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Review}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{thresh}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{train4\PYZus{}clean}\PY{o}{.}\PY{n}{shape}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test4\PYZus{}clean}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
          
          
          \PY{n}{vect4\PYZus{}title} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}
          \PY{n}{vect4\PYZus{}rec} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{X\PYZus{}train4\PYZus{}title} \PY{o}{=} \PY{n}{vect4\PYZus{}title}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train4\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Title}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{X\PYZus{}train4\PYZus{}rev} \PY{o}{=} \PY{n}{vect4\PYZus{}rec}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train4\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Review}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
          
          
          \PY{n}{y\PYZus{}train4} \PY{o}{=} \PY{n}{train4\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
(11088, 3) 
 (3674, 3)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}253}]:} \PY{n}{X\PYZus{}test4\PYZus{}title} \PY{o}{=} \PY{n}{vect4\PYZus{}title}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test4\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Title}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{X\PYZus{}test4\PYZus{}rev} \PY{o}{=} \PY{n}{vect4\PYZus{}rec}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test4\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Review}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test4} \PY{o}{=} \PY{n}{test4\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recommended}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}254}]:} \PY{n}{X\PYZus{}train4\PYZus{}rev}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}254}]:} <11088x10691 sparse matrix of type '<class 'numpy.int64'>'
          	with 484229 stored elements in Compressed Sparse Row format>
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}255}]:} \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{sparse} \PY{k}{import} \PY{n}{hstack}
          \PY{n}{X\PYZus{}train4} \PY{o}{=} \PY{n}{hstack}\PY{p}{(}\PY{p}{[}\PY{n}{X\PYZus{}train4\PYZus{}title}\PY{p}{,}\PY{n}{X\PYZus{}train4\PYZus{}rev}\PY{p}{]}\PY{p}{)}
          \PY{n}{X\PYZus{}test4} \PY{o}{=} \PY{n}{hstack}\PY{p}{(}\PY{p}{[}\PY{n}{X\PYZus{}test4\PYZus{}title}\PY{p}{,}\PY{n}{X\PYZus{}test4\PYZus{}rev}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}256}]:} \PY{n}{X\PYZus{}train4}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}256}]:} <11088x13509 sparse matrix of type '<class 'numpy.int64'>'
          	with 519943 stored elements in COOrdinate format>
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}257}]:} \PY{n}{X\PYZus{}test4}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}257}]:} <3674x13509 sparse matrix of type '<class 'numpy.int64'>'
          	with 172413 stored elements in COOrdinate format>
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}258}]:} \PY{n}{feature\PYZus{}names4\PYZus{}rec} \PY{o}{=} \PY{n}{vect4\PYZus{}rec}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{feature\PYZus{}names4\PYZus{}title} \PY{o}{=} \PY{n}{vect4\PYZus{}title}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg4} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg4}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train4}\PY{p}{,}\PY{n}{y\PYZus{}train4}\PY{p}{)}
          \PY{n}{logreg4}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test4}\PY{p}{,}\PY{n}{y\PYZus{}test4}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}258}]:} 0.902286336418073
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}259}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg4}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test4}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test4}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg4}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test4}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test4}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg4}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test4}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test4}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9411466437440666
Test F1 score:  0.9407492985641195
Test ROC AUC score:  0.8425094037513344

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}260}]:} \PY{n}{logreg4\PYZus{}cv} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{cv} \PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg4\PYZus{}cv}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train4}\PY{p}{,}\PY{n}{y\PYZus{}train4}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg4\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test4}\PY{p}{,}\PY{n}{y\PYZus{}test4}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg4\PYZus{}cv}\PY{o}{.}\PY{n}{C\PYZus{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.9044637996733805
C: [0.35938137]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}261}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg4\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test4}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test4}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg4\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test4}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test4}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg4\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test4}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test4}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9472617964318942
Test F1 score:  0.9423550665133849
Test ROC AUC score:  0.8508956401744107

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}262}]:} \PY{n}{feature\PYZus{}names4} \PY{o}{=} \PY{n}{feature\PYZus{}names4\PYZus{}title} \PY{o}{+} \PY{n}{feature\PYZus{}names4\PYZus{}rec}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}263}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg4\PYZus{}cv}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names4}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{4\PYZhy{}cv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[0.84589754 0.9034575  0.90392548 0.91047887 0.91061117 0.93253227
 0.9519536  0.95338408 0.97296504 1.02365254 1.05601754 1.0682746
 1.08442476 1.11198334 1.12889363 1.20993541 1.23032413 1.26158283
 1.2905034  1.40680532]
['amazing', 'compliments', 'amazing', 'dressed', 'comfy', 'snug', 'flattering', 'cute', 'feminine', 'pretty', 'beautiful', 'comfortable', 'soft', 'great', 'fun', 'perfect', 'nice', 'gorgeous', 'unique', 'love']
[-1.77107997 -1.58985726 -1.36710404 -1.36568999 -1.36421356 -1.34393638
 -1.32129964 -1.30165293 -1.21575726 -1.05696592 -1.0022613  -0.9808555
 -0.97849909 -0.93018708 -0.91623128 -0.90892549 -0.89946732 -0.88713166
 -0.88637835 -0.88356472]
['wanted', 'disappointed', 'returned', 'not', 'disappointing', 'disappointed', 'unflattering', 'meh', 'cheap', 'poor', 'awful', 'sack', 'huge', 'wanted', 'strange', 'returning', 'space', 'scratchy', 'ripped', 'didn']
[-1.77107997 -1.58985726 -1.36710404 -1.36568999 -1.36421356 -1.34393638
 -1.32129964 -1.30165293 -1.21575726 -1.05696592 -1.0022613  -0.9808555
 -0.97849909 -0.93018708 -0.91623128 -0.90892549 -0.89946732 -0.88713166
 -0.88637835 -0.88356472  0.84589754  0.9034575   0.90392548  0.91047887
  0.91061117  0.93253227  0.9519536   0.95338408  0.97296504  1.02365254
  1.05601754  1.0682746   1.08442476  1.11198334  1.12889363  1.20993541
  1.23032413  1.26158283  1.2905034   1.40680532]
['wanted' 'disappointed' 'returned' 'not' 'disappointing' 'disappointed'
 'unflattering' 'meh' 'cheap' 'poor' 'awful' 'sack' 'huge' 'wanted'
 'strange' 'returning' 'space' 'scratchy' 'ripped' 'didn' 'amazing'
 'compliments' 'amazing' 'dressed' 'comfy' 'snug' 'flattering' 'cute'
 'feminine' 'pretty' 'beautiful' 'comfortable' 'soft' 'great' 'fun'
 'perfect' 'nice' 'gorgeous' 'unique' 'love']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_65_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}264}]:} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{y\PYZus{}train4}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}264}]:} 0.8193542568542569
\end{Verbatim}
        
    \subparagraph{We notice that the 3rd case where title and text and
combined gives the best performance in terms of average precision score
(95\%) and roc auc(0.85). We will now evaluate this model on the main
test
set}\label{we-notice-that-the-3rd-case-where-title-and-text-and-combined-gives-the-best-performance-in-terms-of-average-precision-score-95-and-roc-auc0.85.-we-will-now-evaluate-this-model-on-the-main-test-set}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}285}]:} \PY{n}{test\PYZus{}main\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{text}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{test\PYZus{}main\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{test\PYZus{}main\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Review}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}287}]:} \PY{n}{X\PYZus{}test\PYZus{}4} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}main\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{text}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}288}]:} \PY{n}{X\PYZus{}test\PYZus{}4}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}288}]:} <4913x11095 sparse matrix of type '<class 'numpy.int64'>'
          	with 222993 stored elements in Compressed Sparse Row format>
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}273}]:} \PY{n}{test\PYZus{}main}\PY{p}{[}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Title}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Review}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}273}]:} (5872, 2)
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \subparagraph{Task 1 best model
performance:}\label{task-1-best-model-performance}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}291}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg3\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}4}\PY{p}{)}\PY{p}{,}\PY{n}{test\PYZus{}main\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recommended}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg3\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}4}\PY{p}{)}\PY{p}{,}\PY{n}{test\PYZus{}main\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recommended}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg3\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}4}\PY{p}{)}\PY{p}{,}\PY{n}{test\PYZus{}main\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recommended}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9466903289063802
Test F1 score:  0.9355626067854528
Test ROC AUC score:  0.8358385328039326

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \subsection{Task 2 Feature Tuning
(30Pts)}\label{task-2-feature-tuning-30pts}

2.1 Try using TfidfVectorizer instead of CountVectorizer. Does it change
the score? Does it change the important coefficients?

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}292}]:} \PY{c+c1}{\PYZsh{}default params}
          \PY{n}{tfidf} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{p}{)}
          \PY{n}{X\PYZus{}train\PYZus{}tfidf} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}tfidf} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}tfidf} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}tfidf} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}tfidf} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)} 
          \PY{n}{logreg\PYZus{}tfidf} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8938486663037561

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}293}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9627569989591834
Test F1 score:  0.9373594603276582
Test ROC AUC score:  0.8584488016769711

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}294}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[2.09152769 2.10717629 2.16282323 2.18138223 2.1866902  2.19299446
 2.23788403 2.29356988 2.49877849 2.53011144 2.56983854 2.67352853
 2.91574297 3.03577341 3.26645044 3.57812594 3.72868027 4.38837031
 4.44994965 4.97742583]
['beautiful', 'comfy', 'flattering', 'amazing', 'size', 'fun', 'bit', 'compliments', 'perfectly', 'gorgeous', 'fits', 'nice', 'unique', 'with', 'soft', 'little', 'comfortable', 'perfect', 'great', 'love']
[-5.35462342 -4.78297705 -4.03122464 -3.86028034 -3.61485673 -3.44714257
 -3.38903103 -3.38131006 -3.31073098 -3.11817191 -2.96757603 -2.62881655
 -2.62461881 -2.55234671 -2.48326092 -2.43687796 -2.42412503 -2.34249973
 -2.25186984 -2.24767947]
['disappointed', 'wanted', 'not', 'was', 'cheap', 'returned', 'huge', 'unflattering', 'poor', 'returning', 'back', 'disappointing', 'strange', 'looked', 'return', 'bad', 'unfortunately', 'itchy', 'quality', 'nothing']
[-5.35462342 -4.78297705 -4.03122464 -3.86028034 -3.61485673 -3.44714257
 -3.38903103 -3.38131006 -3.31073098 -3.11817191 -2.96757603 -2.62881655
 -2.62461881 -2.55234671 -2.48326092 -2.43687796 -2.42412503 -2.34249973
 -2.25186984 -2.24767947  2.09152769  2.10717629  2.16282323  2.18138223
  2.1866902   2.19299446  2.23788403  2.29356988  2.49877849  2.53011144
  2.56983854  2.67352853  2.91574297  3.03577341  3.26645044  3.57812594
  3.72868027  4.38837031  4.44994965  4.97742583]
['disappointed' 'wanted' 'not' 'was' 'cheap' 'returned' 'huge'
 'unflattering' 'poor' 'returning' 'back' 'disappointing' 'strange'
 'looked' 'return' 'bad' 'unfortunately' 'itchy' 'quality' 'nothing'
 'beautiful' 'comfy' 'flattering' 'amazing' 'size' 'fun' 'bit'
 'compliments' 'perfectly' 'gorgeous' 'fits' 'nice' 'unique' 'with' 'soft'
 'little' 'comfortable' 'perfect' 'great' 'love']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_82_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}295}]:} \PY{c+c1}{\PYZsh{}with CV}
          \PY{n}{tfidf} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{p}{)}
          \PY{n}{X\PYZus{}train\PYZus{}tfidf\PYZus{}cv} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}tfidf\PYZus{}cv} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}cv} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}cv} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}tfidf\PYZus{}cv} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf\PYZus{}cv} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf\PYZus{}cv}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{C\PYZus{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.9066412629286881
C: [2.7825594]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}296}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}cv}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9572133245805011
Test F1 score:  0.9441640892072277
Test ROC AUC score:  0.8653414919249027

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}297}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf\PYZus{}cv}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf\PYZhy{}cv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[2.8381242  2.86257931 2.90621465 3.09881628 3.15788326 3.1664422
 3.23634753 3.4999815  3.51882053 3.52843952 3.67633199 3.70215825
 3.86628888 4.36136156 4.5000131  4.55031686 4.85982095 5.76411508
 5.81387123 6.55973747]
['recommend', 'casual', 'feminine', 'lovely', 'fun', 'versatile', 'fits', 'with', 'compliments', 'amazing', 'perfectly', 'nice', 'gorgeous', 'soft', 'unique', 'little', 'comfortable', 'great', 'perfect', 'love']
[-7.45171713 -6.46594383 -5.06196461 -5.03119636 -5.02742239 -4.57719896
 -4.29440509 -4.20535607 -4.12687403 -4.09306881 -4.04566223 -3.75300874
 -3.67194077 -3.66169901 -3.65471698 -3.64504234 -3.46504659 -3.40386488
 -3.2887141  -3.24527281]
['disappointed', 'wanted', 'cheap', 'not', 'returned', 'poor', 'unflattering', 'huge', 'returning', 'disappointing', 'was', 'strange', 'sack', 'nothing', 'meh', 'back', 'itchy', 'bad', 'awkward', 'shapeless']
[-7.45171713 -6.46594383 -5.06196461 -5.03119636 -5.02742239 -4.57719896
 -4.29440509 -4.20535607 -4.12687403 -4.09306881 -4.04566223 -3.75300874
 -3.67194077 -3.66169901 -3.65471698 -3.64504234 -3.46504659 -3.40386488
 -3.2887141  -3.24527281  2.8381242   2.86257931  2.90621465  3.09881628
  3.15788326  3.1664422   3.23634753  3.4999815   3.51882053  3.52843952
  3.67633199  3.70215825  3.86628888  4.36136156  4.5000131   4.55031686
  4.85982095  5.76411508  5.81387123  6.55973747]
['disappointed' 'wanted' 'cheap' 'not' 'returned' 'poor' 'unflattering'
 'huge' 'returning' 'disappointing' 'was' 'strange' 'sack' 'nothing' 'meh'
 'back' 'itchy' 'bad' 'awkward' 'shapeless' 'recommend' 'casual'
 'feminine' 'lovely' 'fun' 'versatile' 'fits' 'with' 'compliments'
 'amazing' 'perfectly' 'nice' 'gorgeous' 'soft' 'unique' 'little'
 'comfortable' 'great' 'perfect' 'love']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_85_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}298}]:} \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{With CountVectorizer:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg3}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test3}\PY{p}{,}\PY{n}{y\PYZus{}test3}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier and CV: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg3\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test3\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}test3\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{With TfidfVectorizer:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier and CV: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}cv}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
With CountVectorizer:
Test Score with Linear Classifier:  0.8987479586281981
Test Score with Linear Classifier and CV:  0.9009254218835057
With TfidfVectorizer:
Test Score with Linear Classifier:  0.8938486663037561
Test Score with Linear Classifier and CV:  0.9066412629286881

    \end{Verbatim}

    \paragraph{Tfidf Vectorizer leads to a sizeable improvement in avg
precision, roc auc and f1 scores. Also, it has imrpoved test set scores
slightly}\label{tfidf-vectorizer-leads-to-a-sizeable-improvement-in-avg-precision-roc-auc-and-f1-scores.-also-it-has-imrpoved-test-set-scores-slightly}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{n}{coef3} \PY{o}{=} \PY{n}{coefs}\PY{p}{(}\PY{n}{logreg3}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names3}\PY{p}{)}
         \PY{n}{coef3\PYZus{}cv} \PY{o}{=} \PY{n}{coefs}\PY{p}{(}\PY{n}{logreg3\PYZus{}cv}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names3\PYZus{}cv}\PY{p}{)}
         \PY{n}{coef\PYZus{}tfidf} \PY{o}{=} \PY{n}{coefs}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf}\PY{p}{)}
         \PY{n}{coef\PYZus{}tfidf\PYZus{}cv} \PY{o}{=} \PY{n}{coefs}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf\PYZus{}cv}\PY{p}{)}
         \PY{n}{coef\PYZus{}changed} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{coef\PYZus{}tfidf}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n+nb}{set}\PY{p}{(}\PY{n}{coef3}\PY{p}{)}\PY{p}{)}
         \PY{n}{coef\PYZus{}changed\PYZus{}cv} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{coef\PYZus{}tfidf\PYZus{}cv}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n+nb}{set}\PY{p}{(}\PY{n}{coef3\PYZus{}cv}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        NameError                                 Traceback (most recent call last)

        <ipython-input-81-644846c3602c> in <module>()
    ----> 1 coef3 = coefs(logreg3.coef\_[0],feature\_names3)
          2 coef3\_cv = coefs(logreg3\_cv.coef\_[0],feature\_names3\_cv)
          3 coef\_tfidf = coefs(logreg\_tfidf.coef\_[0],feature\_names\_tfidf)
          4 coef\_tfidf\_cv = coefs(logreg\_tfidf\_cv.coef\_[0],feature\_names\_tfidf\_cv)
          5 coef\_changed = list(set(coef\_tfidf)-set(coef3))


        NameError: name 'coefs' is not defined

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}82}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{By using TfidfVectorizer instead of CountVectorizer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ Important Coefficients are changed using Linear Classifier. They are :}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}
               \PY{n+nb}{format}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{coef\PYZus{}changed}\PY{p}{)}\PY{p}{,} \PY{n}{coef\PYZus{}changed}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ Important Coefficients are changed using Linear Classifier CV. They are :}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}
               \PY{n+nb}{format}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{coef\PYZus{}changed\PYZus{}cv}\PY{p}{)}\PY{p}{,} \PY{n}{coef\PYZus{}changed\PYZus{}cv}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
By using TfidfVectorizer instead of CountVectorizer

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        NameError                                 Traceback (most recent call last)

        <ipython-input-82-90eb054cadab> in <module>()
          1 print('By using TfidfVectorizer instead of CountVectorizer')
          2 print("\{\} Important Coefficients are changed using Linear Classifier. They are :\textbackslash{}n\{\}".
    ----> 3       format(len(coef\_changed), coef\_changed))
          4 print("\{\} Important Coefficients are changed using Linear Classifier CV. They are :\textbackslash{}n\{\}".
          5       format(len(coef\_changed\_cv), coef\_changed\_cv))


        NameError: name 'coef\_changed' is not defined

    \end{Verbatim}

    2.2 Remember that TfidfVectorizer uses normalization by default. Does
using a Normalizer with CountVectorizer change the outcome?

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}299}]:} \PY{c+c1}{\PYZsh{}default params}
          \PY{n}{pipe} \PY{o}{=} \PY{n}{Pipeline}\PY{p}{(}\PY{p}{[}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{vect}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{norm}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{Normalizer}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}
          \PY{n}{X\PYZus{}train\PYZus{}vect\PYZus{}norm} \PY{o}{=} \PY{n}{pipe}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}vect\PYZus{}norm} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}norm} \PY{o}{=} \PY{n}{pipe}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}norm} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}vect\PYZus{}norm} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}vect\PYZus{}norm} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}vect\PYZus{}norm}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}vect\PYZus{}norm}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}vect\PYZus{}norm}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}vect\PYZus{}norm}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}norm}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}norm}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8854109961894393

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}300}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}vect\PYZus{}norm}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}norm}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}norm}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}vect\PYZus{}norm}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}norm}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}norm}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}vect\PYZus{}norm}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}norm}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}norm}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9588167355654054
Test F1 score:  0.9324562810845499
Test ROC AUC score:  0.8406109670041559

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}301}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg\PYZus{}vect\PYZus{}norm}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}vect\PYZus{}norm}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vect\PYZhy{}norm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[2.11546514 2.11812685 2.15143136 2.22731376 2.25634018 2.29715048
 2.50858488 2.54229484 2.63528104 2.66174843 2.73191794 2.81655202
 2.98819196 3.02867748 3.55402791 3.83304181 4.09773229 4.17622217
 4.61750103 4.90917801]
['amazing', 'comfy', 'beautiful', 'fun', 'lovely', 'compliments', 'flattering', 'bit', 'gorgeous', 'perfectly', 'with', 'fits', 'unique', 'nice', 'soft', 'little', 'comfortable', 'great', 'love', 'perfect']
[-5.45024073 -5.25181622 -3.64262797 -3.48839304 -3.35485859 -3.35375814
 -3.2054242  -3.18398355 -3.10949235 -3.07154949 -3.05855551 -3.02667404
 -2.80793175 -2.78651428 -2.5125226  -2.4600435  -2.45273509 -2.36851057
 -2.33169082 -2.29468023]
['disappointed', 'wanted', 'huge', 'unflattering', 'returned', 'cheap', 'back', 'not', 'was', 'returning', 'looked', 'poor', 'return', 'quality', 'way', 'unfortunately', 'no', 'fabric', 'itchy', 'thin']
[-5.45024073 -5.25181622 -3.64262797 -3.48839304 -3.35485859 -3.35375814
 -3.2054242  -3.18398355 -3.10949235 -3.07154949 -3.05855551 -3.02667404
 -2.80793175 -2.78651428 -2.5125226  -2.4600435  -2.45273509 -2.36851057
 -2.33169082 -2.29468023  2.11546514  2.11812685  2.15143136  2.22731376
  2.25634018  2.29715048  2.50858488  2.54229484  2.63528104  2.66174843
  2.73191794  2.81655202  2.98819196  3.02867748  3.55402791  3.83304181
  4.09773229  4.17622217  4.61750103  4.90917801]
['disappointed' 'wanted' 'huge' 'unflattering' 'returned' 'cheap' 'back'
 'not' 'was' 'returning' 'looked' 'poor' 'return' 'quality' 'way'
 'unfortunately' 'no' 'fabric' 'itchy' 'thin' 'amazing' 'comfy'
 'beautiful' 'fun' 'lovely' 'compliments' 'flattering' 'bit' 'gorgeous'
 'perfectly' 'with' 'fits' 'unique' 'nice' 'soft' 'little' 'comfortable'
 'great' 'love' 'perfect']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_93_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}302}]:} \PY{c+c1}{\PYZsh{}with CV}
          \PY{n}{pipe} \PY{o}{=} \PY{n}{Pipeline}\PY{p}{(}\PY{p}{[}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{vect}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{norm}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{Normalizer}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}
          \PY{n}{X\PYZus{}train\PYZus{}vect\PYZus{}norm\PYZus{}cv} \PY{o}{=} \PY{n}{pipe}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}vect\PYZus{}norm\PYZus{}cv} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}norm\PYZus{}cv} \PY{o}{=} \PY{n}{pipe}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}norm\PYZus{}cv} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}vect\PYZus{}norm\PYZus{}cv} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}vect\PYZus{}norm\PYZus{}cv} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{o}{.}\PY{n}{C\PYZus{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8962983124659771
C: [2.7825594]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}303}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9533216550076367
Test F1 score:  0.9381393083292743
Test ROC AUC score:  0.8476610097332531

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}304}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vect\PYZhy{}norm\PYZhy{}cv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[3.10909631 3.19564714 3.20049755 3.25115085 3.35014979 3.43662333
 3.50021701 3.50936122 3.83427005 3.8826816  4.01011244 4.12739305
 4.2869086  4.58140123 4.66494523 4.83756943 5.10276402 5.31663753
 5.4209769  6.35477368]
['feminine', 'versatile', 'flattering', 'saw', 'casual', 'lovely', 'fun', 'fits', 'compliments', 'amazing', 'nice', 'perfectly', 'gorgeous', 'soft', 'little', 'great', 'unique', 'comfortable', 'love', 'perfect']
[-8.38014997 -7.50818291 -5.54894674 -5.39225574 -5.32377821 -5.07377691
 -4.93899527 -4.8663299  -4.03298519 -3.87550547 -3.87299922 -3.87262506
 -3.81480378 -3.74055922 -3.73986894 -3.66948387 -3.49747193 -3.36723469
 -3.32297536 -3.31866858]
['disappointed', 'wanted', 'returned', 'cheap', 'unflattering', 'huge', 'returning', 'poor', 'return', 'looked', 'itchy', 'disappointing', 'nothing', 'back', 'bad', 'strange', 'not', 'sack', 'washed', 'quality']
[-8.38014997 -7.50818291 -5.54894674 -5.39225574 -5.32377821 -5.07377691
 -4.93899527 -4.8663299  -4.03298519 -3.87550547 -3.87299922 -3.87262506
 -3.81480378 -3.74055922 -3.73986894 -3.66948387 -3.49747193 -3.36723469
 -3.32297536 -3.31866858  3.10909631  3.19564714  3.20049755  3.25115085
  3.35014979  3.43662333  3.50021701  3.50936122  3.83427005  3.8826816
  4.01011244  4.12739305  4.2869086   4.58140123  4.66494523  4.83756943
  5.10276402  5.31663753  5.4209769   6.35477368]
['disappointed' 'wanted' 'returned' 'cheap' 'unflattering' 'huge'
 'returning' 'poor' 'return' 'looked' 'itchy' 'disappointing' 'nothing'
 'back' 'bad' 'strange' 'not' 'sack' 'washed' 'quality' 'feminine'
 'versatile' 'flattering' 'saw' 'casual' 'lovely' 'fun' 'fits'
 'compliments' 'amazing' 'nice' 'perfectly' 'gorgeous' 'soft' 'little'
 'great' 'unique' 'comfortable' 'love' 'perfect']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_96_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}305}]:} \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{With CountVectorizer:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg3}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test3}\PY{p}{,}\PY{n}{y\PYZus{}test3}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier and CV: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg3\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test3\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}test3\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{With TfidfVectorizer:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier and CV: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{With CountVectorizer and Normalizer:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}vect\PYZus{}norm}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}norm}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}norm}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier and CV: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}norm\PYZus{}cv}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
With CountVectorizer:
Test Score with Linear Classifier:  0.8987479586281981
Test Score with Linear Classifier and CV:  0.9009254218835057
With TfidfVectorizer:
Test Score with Linear Classifier:  0.8938486663037561
Test Score with Linear Classifier and CV:  0.9066412629286881
With CountVectorizer and Normalizer:
Test Score with Linear Classifier:  0.8854109961894393
Test Score with Linear Classifier and CV:  0.8962983124659771

    \end{Verbatim}

    Using normalizer with countvectorizer has marginally improved
performance

    \paragraph{2.3 Try using stop-word. Do the standard English stop-words
help? Why / why
not?}\label{try-using-stop-word.-do-the-standard-english-stop-words-help-why-why-not}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}306}]:} \PY{c+c1}{\PYZsh{}default params}
          \PY{n}{vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{X\PYZus{}train\PYZus{}vect\PYZus{}sw} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}vect\PYZus{}sw} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}sw} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}sw} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}vect\PYZus{}sw} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}vect\PYZus{}sw} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}vect\PYZus{}sw}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}vect\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}vect\PYZus{}sw}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}vect\PYZus{}sw}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}sw}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.896842678279804

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}307}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}vect\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}vect\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}vect\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}sw}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9427435212548922
Test F1 score:  0.9377770481037596
Test ROC AUC score:  0.8370086120002121

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}308}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg\PYZus{}vect\PYZus{}sw}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}vect\PYZus{}sw}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{: CountVectorizer with Stop words}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[1.13122817 1.13658114 1.13938982 1.14638635 1.201373   1.2105783
 1.24508005 1.24512604 1.25067255 1.34808707 1.35607133 1.37295456
 1.41088651 1.43883432 1.4904509  1.49450224 1.50496597 1.53579253
 1.56336435 1.58051794]
['undecided', 'flows', 'sexy', 'ties', 'helps', 'feminine', 'caution', 'elegant', 'beautifully', 'add', 'test', 'honey', 'drop', 'unique', 'pleased', 'amazing', 'dressed', 'versatile', 'stylish', 'compliments']
[-2.23187472 -2.21878404 -2.0312487  -1.97051128 -1.79263101 -1.73418806
 -1.72229867 -1.69288398 -1.55811543 -1.51648496 -1.48449446 -1.47365371
 -1.46474721 -1.46176939 -1.43934002 -1.43897215 -1.40267521 -1.38728859
 -1.36865472 -1.36698248]
['meh', 'awful', 'disappointed', 'sack', 'disappointing', 'returned', 'overpriced', 'shame', 'age', 'shapeless', 'ripped', 'additionally', 'wanted', 'impossible', 'remember', 'cheap', 'strange', 'concept', 'pinks', 'poor']
[-2.23187472 -2.21878404 -2.0312487  -1.97051128 -1.79263101 -1.73418806
 -1.72229867 -1.69288398 -1.55811543 -1.51648496 -1.48449446 -1.47365371
 -1.46474721 -1.46176939 -1.43934002 -1.43897215 -1.40267521 -1.38728859
 -1.36865472 -1.36698248  1.13122817  1.13658114  1.13938982  1.14638635
  1.201373    1.2105783   1.24508005  1.24512604  1.25067255  1.34808707
  1.35607133  1.37295456  1.41088651  1.43883432  1.4904509   1.49450224
  1.50496597  1.53579253  1.56336435  1.58051794]
['meh' 'awful' 'disappointed' 'sack' 'disappointing' 'returned'
 'overpriced' 'shame' 'age' 'shapeless' 'ripped' 'additionally' 'wanted'
 'impossible' 'remember' 'cheap' 'strange' 'concept' 'pinks' 'poor'
 'undecided' 'flows' 'sexy' 'ties' 'helps' 'feminine' 'caution' 'elegant'
 'beautifully' 'add' 'test' 'honey' 'drop' 'unique' 'pleased' 'amazing'
 'dressed' 'versatile' 'stylish' 'compliments']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_102_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}309}]:} \PY{c+c1}{\PYZsh{}with CV and stopwords}
          \PY{n}{vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{X\PYZus{}train\PYZus{}vect\PYZus{}sw\PYZus{}cv} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}vect\PYZus{}sw\PYZus{}cv} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}sw\PYZus{}cv} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}sw\PYZus{}cv} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}vect\PYZus{}sw\PYZus{}cv} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}vect\PYZus{}sw\PYZus{}cv} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{C\PYZus{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8908546543277083
C: [0.04641589]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}310}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9597860202527733
Test F1 score:  0.9355201800932627
Test ROC AUC score:  0.8496498131612679

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}311}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{: CV \PYZam{} CountVectorizer with Stop words}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[0.44232217 0.44372799 0.4503959  0.4573169  0.45736872 0.45745416
 0.46552602 0.47324456 0.4921474  0.49978993 0.5136648  0.52687561
 0.5308046  0.56465259 0.59639531 0.61255577 0.62354827 0.68252145
 0.69587213 0.74585348]
['casual', 'easy', 'lovely', 'comfy', 'nice', 'fits', 'little', 'dressed', 'feminine', 'perfectly', 'versatile', 'gorgeous', 'soft', 'love', 'great', 'amazing', 'compliments', 'comfortable', 'unique', 'perfect']
[-1.1130487  -0.94737919 -0.84963344 -0.73283457 -0.71214146 -0.69075782
 -0.69019049 -0.68558836 -0.62414574 -0.60340188 -0.59150961 -0.56125621
 -0.55226193 -0.53654228 -0.4743584  -0.47013634 -0.47005558 -0.46708256
 -0.46581472 -0.46356465]
['disappointed', 'wanted', 'returned', 'huge', 'unflattering', 'poor', 'returning', 'cheap', 'disappointing', 'strange', 'bad', 'unfortunately', 'return', 'sack', 'scratchy', 'maternity', 'excited', 'awful', 'going', 'sadly']
[-1.1130487  -0.94737919 -0.84963344 -0.73283457 -0.71214146 -0.69075782
 -0.69019049 -0.68558836 -0.62414574 -0.60340188 -0.59150961 -0.56125621
 -0.55226193 -0.53654228 -0.4743584  -0.47013634 -0.47005558 -0.46708256
 -0.46581472 -0.46356465  0.44232217  0.44372799  0.4503959   0.4573169
  0.45736872  0.45745416  0.46552602  0.47324456  0.4921474   0.49978993
  0.5136648   0.52687561  0.5308046   0.56465259  0.59639531  0.61255577
  0.62354827  0.68252145  0.69587213  0.74585348]
['disappointed' 'wanted' 'returned' 'huge' 'unflattering' 'poor'
 'returning' 'cheap' 'disappointing' 'strange' 'bad' 'unfortunately'
 'return' 'sack' 'scratchy' 'maternity' 'excited' 'awful' 'going' 'sadly'
 'casual' 'easy' 'lovely' 'comfy' 'nice' 'fits' 'little' 'dressed'
 'feminine' 'perfectly' 'versatile' 'gorgeous' 'soft' 'love' 'great'
 'amazing' 'compliments' 'comfortable' 'unique' 'perfect']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_105_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}312}]:} \PY{c+c1}{\PYZsh{}default params and tfidf with stop words}
          
          \PY{n}{tfidf} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{X\PYZus{}train\PYZus{}tfidf\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}tfidf\PYZus{}sw} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}sw} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}tfidf\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf\PYZus{}sw} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf\PYZus{}sw}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf\PYZus{}sw}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}sw}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8938486663037561

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}313}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}sw}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9683735664405579
Test F1 score:  0.937699680511182
Test ROC AUC score:  0.86903323518649

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}314}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf\PYZus{}sw}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf \PYZam{} stopwords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[2.24309334 2.27317205 2.29249083 2.29565165 2.35160429 2.36360053
 2.42158491 2.55875488 2.61334287 2.67602534 2.71030247 2.75837011
 2.83883188 3.23322345 3.48019051 3.48050415 3.8497441  4.49913654
 4.71209902 4.9195551 ]
['size', 'bit', 'fun', 'comfy', 'lovely', 'versatile', 'beautiful', 'perfectly', 'amazing', 'nice', 'compliments', 'gorgeous', 'fits', 'unique', 'little', 'soft', 'comfortable', 'great', 'perfect', 'love']
[-5.70946075 -4.85057813 -3.73639444 -3.53734756 -3.48839878 -3.43451937
 -3.38481685 -3.23307691 -2.87287812 -2.84674384 -2.82581412 -2.72887465
 -2.7047743  -2.52016324 -2.4716081  -2.45137907 -2.44178174 -2.43649776
 -2.42454743 -2.35527015]
['disappointed', 'wanted', 'returned', 'cheap', 'huge', 'poor', 'unflattering', 'returning', 'disappointing', 'strange', 'bad', 'unfortunately', 'return', 'looked', 'fabric', 'sack', 'going', 'way', 'maternity', 'awkward']
[-5.70946075 -4.85057813 -3.73639444 -3.53734756 -3.48839878 -3.43451937
 -3.38481685 -3.23307691 -2.87287812 -2.84674384 -2.82581412 -2.72887465
 -2.7047743  -2.52016324 -2.4716081  -2.45137907 -2.44178174 -2.43649776
 -2.42454743 -2.35527015  2.24309334  2.27317205  2.29249083  2.29565165
  2.35160429  2.36360053  2.42158491  2.55875488  2.61334287  2.67602534
  2.71030247  2.75837011  2.83883188  3.23322345  3.48019051  3.48050415
  3.8497441   4.49913654  4.71209902  4.9195551 ]
['disappointed' 'wanted' 'returned' 'cheap' 'huge' 'poor' 'unflattering'
 'returning' 'disappointing' 'strange' 'bad' 'unfortunately' 'return'
 'looked' 'fabric' 'sack' 'going' 'way' 'maternity' 'awkward' 'size' 'bit'
 'fun' 'comfy' 'lovely' 'versatile' 'beautiful' 'perfectly' 'amazing'
 'nice' 'compliments' 'gorgeous' 'fits' 'unique' 'little' 'soft'
 'comfortable' 'great' 'perfect' 'love']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_108_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}315}]:} \PY{c+c1}{\PYZsh{}with CV tfidf with stop words}
          
          \PY{n}{tfidf} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{X\PYZus{}train\PYZus{}tfidf\PYZus{}sw\PYZus{}cv} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}tfidf\PYZus{}sw\PYZus{}cv} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}sw\PYZus{}cv} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}sw\PYZus{}cv} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}tfidf\PYZus{}sw\PYZus{}cv} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{C\PYZus{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.902286336418073
C: [2.7825594]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}316}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.959625936859364
Test F1 score:  0.9418623481781376
Test ROC AUC score:  0.8637643624744401

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}317}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf\PYZhy{}cv \PYZam{} stopwords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[3.12208732 3.13204727 3.13389526 3.17731055 3.19010598 3.39522046
 3.50938111 3.52701653 3.57693134 3.63081836 3.91266679 4.04640978
 4.08363353 4.38968143 4.47229675 4.68826727 4.77137418 5.5457754
 6.04501549 6.16864579]
['stylish', 'glad', 'fun', 'feminine', 'dressed', 'lovely', 'perfectly', 'fits', 'nice', 'versatile', 'gorgeous', 'amazing', 'compliments', 'little', 'soft', 'comfortable', 'unique', 'great', 'perfect', 'love']
[-7.53388133 -6.17636272 -5.08383178 -4.78998201 -4.58673271 -4.23868543
 -4.19697817 -4.12784765 -4.06171244 -3.98678958 -3.95073265 -3.92344061
 -3.84406456 -3.83423518 -3.63657697 -3.45340063 -3.43096836 -3.36442451
 -3.22027304 -3.21963511]
['disappointed', 'wanted', 'returned', 'cheap', 'poor', 'disappointing', 'huge', 'unflattering', 'returning', 'strange', 'sack', 'meh', 'awful', 'bad', 'maternity', 'awkward', 'shapeless', 'scratchy', 'return', 'going']
[-7.53388133 -6.17636272 -5.08383178 -4.78998201 -4.58673271 -4.23868543
 -4.19697817 -4.12784765 -4.06171244 -3.98678958 -3.95073265 -3.92344061
 -3.84406456 -3.83423518 -3.63657697 -3.45340063 -3.43096836 -3.36442451
 -3.22027304 -3.21963511  3.12208732  3.13204727  3.13389526  3.17731055
  3.19010598  3.39522046  3.50938111  3.52701653  3.57693134  3.63081836
  3.91266679  4.04640978  4.08363353  4.38968143  4.47229675  4.68826727
  4.77137418  5.5457754   6.04501549  6.16864579]
['disappointed' 'wanted' 'returned' 'cheap' 'poor' 'disappointing' 'huge'
 'unflattering' 'returning' 'strange' 'sack' 'meh' 'awful' 'bad'
 'maternity' 'awkward' 'shapeless' 'scratchy' 'return' 'going' 'stylish'
 'glad' 'fun' 'feminine' 'dressed' 'lovely' 'perfectly' 'fits' 'nice'
 'versatile' 'gorgeous' 'amazing' 'compliments' 'little' 'soft'
 'comfortable' 'unique' 'great' 'perfect' 'love']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_111_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}318}]:} \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{With CountVectorizer:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg3}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test3}\PY{p}{,}\PY{n}{y\PYZus{}test3}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier and CV: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg3\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test3\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}test3\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{With TfidfVectorizer:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier and CV: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}cv}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
With CountVectorizer:
Test Score with Linear Classifier:  0.8987479586281981
Test Score with Linear Classifier and CV:  0.9009254218835057
With TfidfVectorizer:
Test Score with Linear Classifier:  0.8938486663037561
Test Score with Linear Classifier and CV:  0.9066412629286881

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}319}]:} \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{With CountVectorizer and Stop Words:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}vect\PYZus{}sw}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier and CV: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{With TfidfVectorizer and Stop Words:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score with Linear Classifier and CV: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
With CountVectorizer and Stop Words:
Test Score with Linear Classifier:  0.896842678279804
Test Score with Linear Classifier and CV:  0.8908546543277083
With TfidfVectorizer and Stop Words:
Test Score with Linear Classifier:  0.8938486663037561
Test Score with Linear Classifier and CV:  0.902286336418073

    \end{Verbatim}

    \paragraph{Stop words removal also gives a marginal improvement in avg
precision and roc auc scores. But not much in terms of accuracy. Thus
removal of stop words improves performance of this imbalanced model.
Also, a reduction in features is observed which saves computational
cost}\label{stop-words-removal-also-gives-a-marginal-improvement-in-avg-precision-and-roc-auc-scores.-but-not-much-in-terms-of-accuracy.-thus-removal-of-stop-words-improves-performance-of-this-imbalanced-model.-also-a-reduction-in-features-is-observed-which-saves-computational-cost}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}320}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Lenght of feature\PYZus{}names before stop words removal:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{before}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{bsw} \PY{o}{=} \PY{p}{[}\PY{n}{feature\PYZus{}names3}\PY{p}{,} \PY{n}{feature\PYZus{}names3\PYZus{}cv}\PY{p}{,} \PY{n}{feature\PYZus{}names\PYZus{}tfidf}\PY{p}{,} \PY{n}{feature\PYZus{}names\PYZus{}tfidf\PYZus{}cv}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{bsw}\PY{p}{:}
              \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)}
          \PY{n}{asw} \PY{o}{=} \PY{p}{[}\PY{n}{feature\PYZus{}names\PYZus{}vect\PYZus{}sw}\PY{p}{,} \PY{n}{feature\PYZus{}names\PYZus{}vect\PYZus{}sw\PYZus{}cv}\PY{p}{,} \PY{n}{feature\PYZus{}names\PYZus{}tfidf\PYZus{}sw}\PY{p}{,} \PY{n}{feature\PYZus{}names\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{p}{]}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{after}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{asw}\PY{p}{:}
              \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Lenght of feature\_names before stop words removal:
before
11095
11095
11095
11095
after
10814
10814
10814
10814

    \end{Verbatim}

    The features were reduced by merely 280 which is less than 2.25\%. So,
no much impact on stop words removal

    \paragraph{2.4 Limit the vocabulary using min\_df or max\_df. How to
these impact the number of features, and how do they impact the
scores?}\label{limit-the-vocabulary-using-minux5fdf-or-maxux5fdf.-how-to-these-impact-the-number-of-features-and-how-do-they-impact-the-scores}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}321}]:} \PY{k}{def} \PY{n+nf}{min\PYZus{}df}\PY{p}{(}\PY{n}{feature\PYZus{}count}\PY{p}{,}\PY{n}{test\PYZus{}scores}\PY{p}{,}\PY{n}{title}\PY{p}{)}\PY{p}{:}
              \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{)}\PY{p}{,}\PY{n}{feature\PYZus{}count}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{title}\PY{p}{)}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min\PYZus{}df}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{)}\PY{p}{,}\PY{n}{test\PYZus{}scores}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min\PYZus{}df}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZhy{}set score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}322}]:} \PY{n}{feature\PYZus{}count\PYZus{}vect} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{n}{test\PYZus{}scores\PYZus{}vect} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{)}\PY{p}{:}
          \PY{c+c1}{\PYZsh{}default params}
              \PY{n}{vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{min\PYZus{}df} \PY{o}{=} \PY{n}{i}\PY{p}{)}
              \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}train} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
              \PY{n}{feature\PYZus{}count\PYZus{}vect}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{)}\PY{p}{)}
              \PY{n}{logreg} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
              \PY{n}{logreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
              \PY{n}{test\PYZus{}scores\PYZus{}vect}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}323}]:} \PY{n}{min\PYZus{}df}\PY{p}{(}\PY{n}{feature\PYZus{}count\PYZus{}vect}\PY{p}{,}\PY{n}{test\PYZus{}scores\PYZus{}vect}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CountVectorizer default params}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_120_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_120_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}324}]:} \PY{n}{feature\PYZus{}count\PYZus{}vect\PYZus{}cv} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{n}{test\PYZus{}scores\PYZus{}vect\PYZus{}cv} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{)}\PY{p}{:}
          \PY{c+c1}{\PYZsh{}default params and CV}
              \PY{n}{vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{min\PYZus{}df} \PY{o}{=} \PY{n}{i}\PY{p}{)}
              \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}train} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
              \PY{n}{feature\PYZus{}count\PYZus{}vect\PYZus{}cv}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{)}\PY{p}{)}
              \PY{n}{logreg} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{logreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
              \PY{n}{test\PYZus{}scores\PYZus{}vect\PYZus{}cv}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}325}]:} \PY{n}{min\PYZus{}df}\PY{p}{(}\PY{n}{feature\PYZus{}count\PYZus{}vect\PYZus{}cv}\PY{p}{,}\PY{n}{test\PYZus{}scores\PYZus{}vect\PYZus{}cv}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CountVectorizer with CV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_122_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_122_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}326}]:} \PY{n}{feature\PYZus{}count\PYZus{}tfidf} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{n}{test\PYZus{}scores\PYZus{}tfidf} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{c+c1}{\PYZsh{}default params and tfidf}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{)}\PY{p}{:}
              \PY{n}{tfidf} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{min\PYZus{}df} \PY{o}{=} \PY{n}{i}\PY{p}{)}
              \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}train} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)} 
              \PY{n}{feature\PYZus{}count\PYZus{}tfidf}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{)}\PY{p}{)}
              \PY{n}{logreg} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
              \PY{n}{logreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
              \PY{n}{test\PYZus{}scores\PYZus{}tfidf}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}327}]:} \PY{n}{min\PYZus{}df}\PY{p}{(}\PY{n}{feature\PYZus{}count\PYZus{}tfidf}\PY{p}{,}\PY{n}{test\PYZus{}scores\PYZus{}tfidf}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tfidf with default params}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_124_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_124_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}328}]:} \PY{n}{feature\PYZus{}count\PYZus{}tfidf\PYZus{}cv} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{n}{test\PYZus{}scores\PYZus{}tfidf\PYZus{}cv} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{c+c1}{\PYZsh{}default params and tfidf}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{)}\PY{p}{:}
              \PY{n}{tfidf} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{min\PYZus{}df} \PY{o}{=} \PY{n}{i}\PY{p}{)}
              \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}train} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)} 
              \PY{n}{feature\PYZus{}count\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{)}\PY{p}{)}
              \PY{n}{logreg} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{logreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
              \PY{n}{test\PYZus{}scores\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}329}]:} \PY{n}{min\PYZus{}df}\PY{p}{(}\PY{n}{feature\PYZus{}count\PYZus{}tfidf\PYZus{}cv}\PY{p}{,}\PY{n}{test\PYZus{}scores\PYZus{}tfidf\PYZus{}cv}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tfidf with CV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_126_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_126_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subparagraph{max\_df}\label{maxux5fdf}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}421}]:} \PY{k}{def} \PY{n+nf}{max\PYZus{}df}\PY{p}{(}\PY{n}{feature\PYZus{}count}\PY{p}{,}\PY{n}{test\PYZus{}scores}\PY{p}{,}\PY{n}{title}\PY{p}{)}\PY{p}{:}
              \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}\PY{p}{,}\PY{n}{feature\PYZus{}count}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{title}\PY{p}{)}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}df}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}\PY{p}{,}\PY{n}{test\PYZus{}scores}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}df}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZhy{}set score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}422}]:} \PY{n}{feature\PYZus{}count\PYZus{}vect} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{n}{test\PYZus{}scores\PYZus{}vect} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}\PY{p}{:}
          \PY{c+c1}{\PYZsh{}default params}
              \PY{n}{vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{max\PYZus{}df} \PY{o}{=} \PY{n}{i}\PY{p}{)}
              \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}train} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
              \PY{n}{feature\PYZus{}count\PYZus{}vect}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{)}\PY{p}{)}
              \PY{n}{logreg} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
              \PY{n}{logreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
              \PY{n}{test\PYZus{}scores\PYZus{}vect}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}423}]:} \PY{n}{max\PYZus{}df}\PY{p}{(}\PY{n}{feature\PYZus{}count\PYZus{}vect}\PY{p}{,}\PY{n}{test\PYZus{}scores\PYZus{}vect}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CountVectorizer default params}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_130_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_130_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}424}]:} \PY{n}{feature\PYZus{}count\PYZus{}vect\PYZus{}cv} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{n}{test\PYZus{}scores\PYZus{}vect\PYZus{}cv} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}\PY{p}{:}
          \PY{c+c1}{\PYZsh{}default params and CV}
              \PY{n}{vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{max\PYZus{}df} \PY{o}{=} \PY{n}{i}\PY{p}{)}
              \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}train} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n}{vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
              \PY{n}{feature\PYZus{}count\PYZus{}vect\PYZus{}cv}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{)}\PY{p}{)}
              \PY{n}{logreg} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{logreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
              \PY{n}{test\PYZus{}scores\PYZus{}vect\PYZus{}cv}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}425}]:} \PY{n}{max\PYZus{}df}\PY{p}{(}\PY{n}{feature\PYZus{}count\PYZus{}vect\PYZus{}cv}\PY{p}{,}\PY{n}{test\PYZus{}scores\PYZus{}vect\PYZus{}cv}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CountVectorizer with CV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_132_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_132_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}426}]:} \PY{n}{feature\PYZus{}count\PYZus{}tfidf} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{n}{test\PYZus{}scores\PYZus{}tfidf} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{c+c1}{\PYZsh{}default params and tfidf}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}\PY{p}{:}
              \PY{n}{tfidf} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{max\PYZus{}df} \PY{o}{=} \PY{n}{i}\PY{p}{)}
              \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}train} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)} 
              \PY{n}{feature\PYZus{}count\PYZus{}tfidf}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{)}\PY{p}{)}
              \PY{n}{logreg} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}
              \PY{n}{logreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
              \PY{n}{test\PYZus{}scores\PYZus{}tfidf}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}427}]:} \PY{n}{max\PYZus{}df}\PY{p}{(}\PY{n}{feature\PYZus{}count\PYZus{}tfidf}\PY{p}{,}\PY{n}{test\PYZus{}scores\PYZus{}tfidf}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tfidf with default params}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_134_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_134_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}428}]:} \PY{n}{feature\PYZus{}count\PYZus{}tfidf\PYZus{}cv} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{n}{test\PYZus{}scores\PYZus{}tfidf\PYZus{}cv} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{c+c1}{\PYZsh{}default params and tfidf}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}\PY{p}{:}
              \PY{n}{tfidf} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{max\PYZus{}df} \PY{o}{=} \PY{n}{i}\PY{p}{)}
              \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}train} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)} 
              \PY{n}{feature\PYZus{}count\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{)}\PY{p}{)}
              \PY{n}{logreg} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{logreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
              \PY{n}{test\PYZus{}scores\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}429}]:} \PY{n}{max\PYZus{}df}\PY{p}{(}\PY{n}{feature\PYZus{}count\PYZus{}tfidf\PYZus{}cv}\PY{p}{,}\PY{n}{test\PYZus{}scores\PYZus{}tfidf\PYZus{}cv}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tfidf with CV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_136_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_136_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    It is seen clearly that with increase in min\_df number of features are
reducing and with increase in max\_df number of features are increasing

Also, variation in both min\_df and max\_df has changed the test scores
very slightly only. Thus with almost negligible loss in average
precision score we get a significant reduction in number of features

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \subparagraph{Now we evaluate the best model of Task 2 with the main
test
set}\label{now-we-evaluate-the-best-model-of-task-2-with-the-main-test-set}

The tfidf with stop words has the best model performance on the basis of
average precision score and roc auc

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}358}]:} \PY{n}{tfidf} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{X\PYZus{}train\PYZus{}tfidf\PYZus{}sw\PYZus{}cv} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{X\PYZus{}test\PYZus{}4} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}main\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{text}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}4}\PY{p}{)}\PY{p}{,}\PY{n}{test\PYZus{}main\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recommended}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}4}\PY{p}{)}\PY{p}{,}\PY{n}{test\PYZus{}main\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recommended}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}4}\PY{p}{)}\PY{p}{,}\PY{n}{test\PYZus{}main\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recommended}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9530968742631256
Test F1 score:  0.9383586626139818
Test ROC AUC score:  0.8487014682445492

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}333}]:} \PY{c+c1}{\PYZsh{}logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}4}\PY{p}{)}\PY{p}{,}\PY{n}{test\PYZus{}main\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recommended}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}4}\PY{p}{)}\PY{p}{,}\PY{n}{test\PYZus{}main\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recommended}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf\PYZus{}sw\PYZus{}cv}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}4}\PY{p}{)}\PY{p}{,}\PY{n}{test\PYZus{}main\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recommended}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9530968742631256
Test F1 score:  0.9383586626139818
Test ROC AUC score:  0.8487014682445492

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \subsection{Task 3 n-grams (30Pts)}\label{task-3-n-grams-30pts}

3.1 Using your current best model, try changing from unigrams to n-grams
of varying length. What provides the best performance? Visualize the
coefficients. Try visualizing only the higher-order n-grams that are
important.

    \paragraph{In terms of average precision scores and roc auc the best
model from all the previous tasks is tfidf vectorizer with stop
words}\label{in-terms-of-average-precision-scores-and-roc-auc-the-best-model-from-all-the-previous-tasks-is-tfidf-vectorizer-with-stop-words}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}330}]:} \PY{n}{tfidf22} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{X\PYZus{}train\PYZus{}tfidf22\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf22}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}tfidf22\PYZus{}sw} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}tfidf22\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf22}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}tfidf22\PYZus{}sw} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}tfidf22\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf22}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf22\PYZus{}sw} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf22\PYZus{}sw}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf22\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf22\PYZus{}sw}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf22\PYZus{}sw}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf22\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf22\PYZus{}sw}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8489384866630375

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}345}]:} \PY{n}{X\PYZus{}train\PYZus{}tfidf22\PYZus{}sw}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}345}]:} <11088x156338 sparse matrix of type '<class 'numpy.float64'>'
          	with 302647 stored elements in Compressed Sparse Row format>
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}331}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf22\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf22\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf22\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf22\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf22\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf22\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf22\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf22\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf22\PYZus{}sw}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9886119348421321
Test F1 score:  0.9149425287356322
Test ROC AUC score:  0.8645543799874472

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}139}]:} \PY{n}{colour} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{40}\PY{p}{)}\PY{p}{:}
              \PY{k}{if} \PY{n}{i} \PY{o}{\PYZlt{}} \PY{l+m+mi}{20}\PY{p}{:}
                  \PY{n}{colour}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{red}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
              \PY{k}{else}\PY{p}{:}
                  \PY{n}{colour}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
              
          \PY{k}{def} \PY{n+nf}{plot2}\PY{p}{(}\PY{n}{coef}\PY{p}{,}\PY{n}{feature\PYZus{}names}\PY{p}{,}\PY{n}{titl}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}plots top 20 features}
              \PY{n}{top300\PYZus{}index\PYZus{}pos} \PY{o}{=} \PY{n}{coef}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{300}\PY{p}{:}\PY{p}{]}
              \PY{n}{top300\PYZus{}names\PYZus{}pos} \PY{o}{=} \PY{p}{[}\PY{n}{feature\PYZus{}names}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n}{top300\PYZus{}index\PYZus{}pos}\PY{p}{]}
              \PY{n}{top300\PYZus{}coef\PYZus{}pos} \PY{o}{=} \PY{n}{coef}\PY{p}{[}\PY{n}{top300\PYZus{}index\PYZus{}pos}\PY{p}{]}
          \PY{c+c1}{\PYZsh{}     print (top300\PYZus{}coef\PYZus{}pos)}
              \PY{n}{names\PYZus{}pos} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              \PY{n}{coef\PYZus{}pos} \PY{o}{=}\PY{p}{[}\PY{p}{]}
              \PY{n}{total} \PY{o}{=} \PY{l+m+mi}{1}
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{300}\PY{p}{)}\PY{p}{:}
                  \PY{k}{if} \PY{n}{total} \PY{o}{\PYZlt{}}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{:}
                      \PY{k}{if} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{in} \PY{n}{top300\PYZus{}names\PYZus{}pos}\PY{p}{[}\PY{l+m+mi}{299}\PY{o}{\PYZhy{}}\PY{n}{i}\PY{p}{]}\PY{p}{:}
                          \PY{n}{names\PYZus{}pos}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{top300\PYZus{}names\PYZus{}pos}\PY{p}{[}\PY{l+m+mi}{299}\PY{o}{\PYZhy{}}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                          \PY{n}{coef\PYZus{}pos}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{top300\PYZus{}coef\PYZus{}pos}\PY{p}{[}\PY{l+m+mi}{299}\PY{o}{\PYZhy{}}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                          \PY{n}{total} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
          
          
              \PY{n}{top300\PYZus{}index\PYZus{}neg} \PY{o}{=} \PY{n}{coef}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{]}
              \PY{n}{top300\PYZus{}names\PYZus{}neg} \PY{o}{=} \PY{p}{[}\PY{n}{feature\PYZus{}names}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n}{top300\PYZus{}index\PYZus{}neg}\PY{p}{]}
              \PY{n}{top300\PYZus{}coef\PYZus{}neg} \PY{o}{=} \PY{n}{coef}\PY{p}{[}\PY{n}{top300\PYZus{}index\PYZus{}neg}\PY{p}{]}
              \PY{n}{names\PYZus{}neg} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              \PY{n}{coef\PYZus{}neg} \PY{o}{=}\PY{p}{[}\PY{p}{]}
              \PY{n}{total} \PY{o}{=} \PY{l+m+mi}{1}
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{300}\PY{p}{)}\PY{p}{:}
                  \PY{k}{if} \PY{n}{total} \PY{o}{\PYZlt{}}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{:}
                      \PY{k}{if} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{in} \PY{n}{top300\PYZus{}names\PYZus{}neg}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{:}
                          \PY{n}{names\PYZus{}neg}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{top300\PYZus{}names\PYZus{}neg}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                          \PY{n}{coef\PYZus{}neg}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{top300\PYZus{}coef\PYZus{}neg}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                          \PY{n}{total} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
          
              \PY{n}{top\PYZus{}coef} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{[}\PY{n}{coef\PYZus{}neg}\PY{p}{,}\PY{n}{coef\PYZus{}pos}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{)}
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{top\PYZus{}coef}\PY{p}{)}
              \PY{n}{top\PYZus{}names} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{[}\PY{n}{names\PYZus{}neg}\PY{p}{,}\PY{n}{names\PYZus{}pos}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{)}
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{top\PYZus{}names}\PY{p}{)}
          
              \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{)}\PY{p}{,}\PY{n}{top\PYZus{}coef}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{n}{colour}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{20 most important features }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{titl}\PY{p}{)}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{)}\PY{p}{,}\PY{n}{top\PYZus{}names}\PY{p}{,}\PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}140}]:} \PY{n}{plot2}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf22\PYZus{}sw}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf22\PYZus{}sw}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf \PYZam{} stopwords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[-9.89153026 -7.40883159 -7.25793166 -5.37460345 -5.15416228 -4.97612901
 -4.59765652 -4.42730344 -4.1570644  -3.89734986 -3.51022232 -3.28167424
 -3.19498293 -3.12261321 -2.94847273 -2.88354451 -2.87001837 -2.81674339
 -2.70940987 -2.69536506  2.6638098   2.69098415  2.7169936   2.72186052
  2.77909289  2.79374033  2.80041215  2.99576014  3.01047788  3.08309091
  3.13010298  3.17795158  3.18684767  3.2630977   3.66334684  3.85816849
  4.00612924  4.55173626  4.59992499  4.93492602]
['wanted love' 'looked like' 'poor quality' 'high hopes' 'wanted like'
 'really wanted' 'didn work' 'looks like' 'felt like' 'way big' 'did work'
 'strange fit' 'just okay' 'sadly going' 'look like' 'looks cheap'
 'lay flat' 'like tent' 'feels cheap' 'disappointed quality' 'super cute'
 'super soft' 'fit perfectly' 'super comfortable' 'perfect fit'
 'fit perfect' 'easy wear' 'fits great' 'skinny jeans' 'great fit'
 'looks great' 'wait wear' 'received compliments' 'absolutely love'
 'just right' 'highly recommend' 'love dress' 'love love' 'true size'
 'fits perfectly']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_151_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}119}]:} \PY{n}{tfidf12} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{X\PYZus{}train\PYZus{}tfidf12\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf12}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}tfidf12\PYZus{}sw} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}tfidf12\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf12}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}tfidf12\PYZus{}sw} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}tfidf12\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf12}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf12\PYZus{}sw} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf12\PYZus{}sw}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf12\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf12\PYZus{}sw}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf12\PYZus{}sw}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf12\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf12\PYZus{}sw}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.9043354365967841

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}120}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf12\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf12\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf12\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf12\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf12\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf12\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf12\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf12\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf12\PYZus{}sw}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9562402857747404
Test F1 score:  0.9427666829030686
Test ROC AUC score:  0.8619553529686769

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}141}]:} \PY{n}{plot2}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf12\PYZus{}sw}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf12\PYZus{}sw}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf \PYZam{} stopwords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[-11.69801927  -6.73712187  -5.41815033  -5.39648805  -5.20211385
  -4.36842375  -4.19307605  -4.06430097  -3.98936339  -3.77680496
  -3.51468419  -3.49765593  -3.47684654  -3.27040375  -3.18715634
  -3.15306869  -2.9793406   -2.95383939  -2.92573818  -2.91619746
   2.66479549   2.66479549   2.69770799   2.72157348   2.77150483
   2.79014634   2.80854011   2.80901199   2.86332113   2.88463928
   2.9377724    2.94774184   3.24449917   3.41012066   3.48870708
   3.60972567   3.61990861   3.74131716   3.74536562   3.98295195]
['wanted love' 'looked like' 'really wanted' 'wanted like' 'poor quality'
 'did work' 'didn work' 'high hopes' 'just okay' 'pretty short'
 'strange fit' 'way big' 'great beautiful' 'don think' 'really looking'
 'excited dress' 'want love' 'beautiful bright' 'beautiful model'
 'loved color' 'bells send' 'love bells' 'really large' 'high quality'
 'love love' 'good quality' 'fabric soft' 'big really' 'really nice'
 'highly recommend' 'long arms' 'beautiful dress' 'love dress'
 'cut flattering' 'small loved' 'better person' 'love shirt' 'just right'
 'fits perfectly' 'really like']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_155_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}122}]:} \PY{n}{logreg\PYZus{}tfidf12\PYZus{}sw}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}122}]:} array([0.92111827, 0.06139087, 0.19457047, {\ldots}, 0.07799795, 0.05367791,
                 0.05367791])
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}123}]:} \PY{c+c1}{\PYZsh{}from sklearn.feature\PYZus{}extraction.text import TfidfVectorizer}
          \PY{k+kn}{from} \PY{n+nn}{collections} \PY{k}{import} \PY{n}{defaultdict}
          
          \PY{c+c1}{\PYZsh{}lectures = [\PYZdq{}this is some food\PYZdq{}, \PYZdq{}this is some drink\PYZdq{}]}
          \PY{c+c1}{\PYZsh{}vectorizer = TfidfVectorizer(ngram\PYZus{}range=(1,2))}
          \PY{c+c1}{\PYZsh{}X = vectorizer.fit\PYZus{}transform(lectures)}
          \PY{n}{features\PYZus{}by\PYZus{}gram} \PY{o}{=} \PY{n}{defaultdict}\PY{p}{(}\PY{n+nb}{list}\PY{p}{)}
          \PY{k}{for} \PY{n}{f}\PY{p}{,} \PY{n}{w} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{feature\PYZus{}names\PYZus{}tfidf12\PYZus{}sw}\PY{p}{,} \PY{n}{tfidf12}\PY{o}{.}\PY{n}{idf\PYZus{}}\PY{p}{)}\PY{p}{:}
              \PY{n}{features\PYZus{}by\PYZus{}gram}\PY{p}{[}\PY{n+nb}{len}\PY{p}{(}\PY{n}{f}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{n}{f}\PY{p}{,} \PY{n}{w}\PY{p}{)}\PY{p}{)}
          \PY{n}{top\PYZus{}n} \PY{o}{=} \PY{l+m+mi}{2}
          \PY{k}{for} \PY{n}{gram}\PY{p}{,} \PY{n}{features} \PY{o+ow}{in} \PY{n}{features\PYZus{}by\PYZus{}gram}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
              \PY{n}{top\PYZus{}features} \PY{o}{=} \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{key}\PY{o}{=}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{reverse}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{n}{top\PYZus{}n}\PY{p}{]}
              \PY{n}{top\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{n}{f}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{k}{for} \PY{n}{f} \PY{o+ow}{in} \PY{n}{top\PYZus{}features}\PY{p}{]}
              \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZhy{}gram top:}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{gram}\PY{p}{)}\PY{p}{,} \PY{n}{top\PYZus{}features}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
1-gram top: ['03', '03dd']
2-gram top: ['00 115', '00 24']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}363}]:} \PY{n}{tfidf33} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf33\PYZus{}sw}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}sw}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8173652694610778

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}366}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.99813265007646756
Test F1 score:  0.8995057660626029
Test ROC AUC score:  0.8663098002114658389

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}143}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}sw}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf33\PYZus{}sw}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf \PYZam{} stopwords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[0.27769891 0.28144258 0.28323473 0.29069194 0.29079684 0.29129772
 0.29646217 0.30172146 0.31197023 0.31270705 0.31885576 0.33036784
 0.36047008 0.36620191 0.3714412  0.44548365 0.54874357 0.61409926
 1.00756163 1.07588418]
['dress bought dress', 'looks better person', 'small fit perfectly', 'great skinny jeans', 'runs little big', 'fits like glove', 'absolutely love dress', 'wish came colors', 'compliments time wear', 'does run large', 'size fits perfectly', 'perfect summer dress', 'love love dress', 'small fits perfectly', 'looks great jeans', 'fit true size', 'dress love dress', 'runs true size', 'fits true size', 'love love love']
[-1.59321089 -1.26093855 -1.18147231 -0.68270773 -0.58649065 -0.53065975
 -0.48406289 -0.42886997 -0.41875689 -0.39347424 -0.38049487 -0.36596123
 -0.36422625 -0.35642819 -0.35546267 -0.34494998 -0.33289932 -0.3155874
 -0.30898285 -0.29817724]
['really wanted love', 'wanted love dress', 'really wanted like', 'just didn work', 'just wasn flattering', 'looks great model', 'looked like wearing', 'wanted like dress', 'really looking forward', 'wanted love wanted', 'love wanted love', 'looked like sack', 'looked like maternity', 'wanted love just', 'really wanted work', 'looks like maternity', 'dress looked like', 'felt like wearing', 'like maternity dress', 'wanted love really']
[-1.59321089 -1.26093855 -1.18147231 -0.68270773 -0.58649065 -0.53065975
 -0.48406289 -0.42886997 -0.41875689 -0.39347424 -0.38049487 -0.36596123
 -0.36422625 -0.35642819 -0.35546267 -0.34494998 -0.33289932 -0.3155874
 -0.30898285 -0.29817724  0.27769891  0.28144258  0.28323473  0.29069194
  0.29079684  0.29129772  0.29646217  0.30172146  0.31197023  0.31270705
  0.31885576  0.33036784  0.36047008  0.36620191  0.3714412   0.44548365
  0.54874357  0.61409926  1.00756163  1.07588418]
['really wanted love' 'wanted love dress' 'really wanted like'
 'just didn work' 'just wasn flattering' 'looks great model'
 'looked like wearing' 'wanted like dress' 'really looking forward'
 'wanted love wanted' 'love wanted love' 'looked like sack'
 'looked like maternity' 'wanted love just' 'really wanted work'
 'looks like maternity' 'dress looked like' 'felt like wearing'
 'like maternity dress' 'wanted love really' 'dress bought dress'
 'looks better person' 'small fit perfectly' 'great skinny jeans'
 'runs little big' 'fits like glove' 'absolutely love dress'
 'wish came colors' 'compliments time wear' 'does run large'
 'size fits perfectly' 'perfect summer dress' 'love love dress'
 'small fits perfectly' 'looks great jeans' 'fit true size'
 'dress love dress' 'runs true size' 'fits true size' 'love love love']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_161_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}144}]:} \PY{n}{plot2}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}sw}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf33\PYZus{}sw}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf \PYZam{} stopwords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[-1.59321089 -1.26093855 -1.18147231 -0.68270773 -0.58649065 -0.53065975
 -0.48406289 -0.42886997 -0.41875689 -0.39347424 -0.38049487 -0.36596123
 -0.36422625 -0.35642819 -0.35546267 -0.34494998 -0.33289932 -0.3155874
 -0.30898285 -0.29817724  0.27769891  0.28144258  0.28323473  0.29069194
  0.29079684  0.29129772  0.29646217  0.30172146  0.31197023  0.31270705
  0.31885576  0.33036784  0.36047008  0.36620191  0.3714412   0.44548365
  0.54874357  0.61409926  1.00756163  1.07588418]
['really wanted love' 'wanted love dress' 'really wanted like'
 'just didn work' 'just wasn flattering' 'looks great model'
 'looked like wearing' 'wanted like dress' 'really looking forward'
 'wanted love wanted' 'love wanted love' 'looked like sack'
 'looked like maternity' 'wanted love just' 'really wanted work'
 'looks like maternity' 'dress looked like' 'felt like wearing'
 'like maternity dress' 'wanted love really' 'dress bought dress'
 'looks better person' 'small fit perfectly' 'great skinny jeans'
 'runs little big' 'fits like glove' 'absolutely love dress'
 'wish came colors' 'compliments time wear' 'does run large'
 'size fits perfectly' 'perfect summer dress' 'love love dress'
 'small fits perfectly' 'looks great jeans' 'fit true size'
 'dress love dress' 'runs true size' 'fits true size' 'love love love']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_162_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}334}]:} \PY{n}{tfidf33} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{X\PYZus{}train\PYZus{}tfidf33} \PY{o}{=} \PY{n}{tfidf33}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}tfidf33} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}tfidf33} \PY{o}{=} \PY{n}{tfidf33}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}tfidf33} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}tfidf33} \PY{o}{=} \PY{n}{tfidf33}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf33} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf33}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf33}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf33}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf33}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8696243875884594

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}338}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9760725673059305
Test F1 score:  0.9250273908279857
Test ROC AUC score:  0.8530222484741091

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}339}]:} \PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}sw}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}339}]:} <14762x353532 sparse matrix of type '<class 'numpy.float64'>'
          	with 392215 stored elements in Compressed Sparse Row format>
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}340}]:} \PY{n}{X\PYZus{}train\PYZus{}tfidf33}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}340}]:} <11088x388498 sparse matrix of type '<class 'numpy.float64'>'
          	with 637545 stored elements in Compressed Sparse Row format>
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}126}]:} \PY{n}{tfidf23} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{X\PYZus{}train\PYZus{}tfidf23\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf23}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}tfidf23\PYZus{}sw} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}tfidf23\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf23}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}tfidf23\PYZus{}sw} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}tfidf23\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf23}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf23\PYZus{}sw} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf23\PYZus{}sw}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf23\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf23\PYZus{}sw}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf23\PYZus{}sw}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf23\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf23\PYZus{}sw}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8662731528597598

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}127}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf23\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf23\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf23\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf23\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf23\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf23\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf23\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf23\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf23\PYZus{}sw}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9702760317758865
Test F1 score:  0.9227694839543905
Test ROC AUC score:  0.8325292323740892

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}129}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf23\PYZus{}sw}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf23\PYZus{}sw}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf \PYZam{} stopwords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[11.48649225 11.50350149 11.8966814  11.94115261 12.21720419 12.41381576
 12.45775746 12.46985121 12.5009868  12.74842429 12.81347263 13.14136791
 13.75151701 13.7834796  15.61901639 15.9444128  16.00208149 17.20289754
 17.45909013 20.68657209]
['glad did', 'fabric soft', 'better person', 'easy wear', 'super comfortable', 'fit perfect', 'perfect fit', 'great fit', 'skinny jeans', 'fits great', 'looks great', 'received compliments', 'absolutely love', 'wait wear', 'just right', 'love love', 'highly recommend', 'true size', 'love dress', 'fits perfectly']
[-46.18113309 -37.2860512  -36.23934701 -27.90896706 -24.24185099
 -22.68180366 -21.25844586 -21.17137736 -19.83464956 -19.37035545
 -17.72350007 -17.57990174 -16.79285084 -16.71574845 -15.31566129
 -14.67284075 -14.40880132 -14.17441056 -14.15149482 -13.27736212]
['wanted love', 'poor quality', 'looked like', 'high hopes', 'wanted like', 'didn work', 'looks like', 'really wanted', 'felt like', 'way big', 'did work', 'strange fit', 'sadly going', 'just okay', 'looks cheap', 'lay flat', 'disappointed quality', 'feels cheap', 'like tent', 'excited dress']
[-46.18113309 -37.2860512  -36.23934701 -27.90896706 -24.24185099
 -22.68180366 -21.25844586 -21.17137736 -19.83464956 -19.37035545
 -17.72350007 -17.57990174 -16.79285084 -16.71574845 -15.31566129
 -14.67284075 -14.40880132 -14.17441056 -14.15149482 -13.27736212
  11.48649225  11.50350149  11.8966814   11.94115261  12.21720419
  12.41381576  12.45775746  12.46985121  12.5009868   12.74842429
  12.81347263  13.14136791  13.75151701  13.7834796   15.61901639
  15.9444128   16.00208149  17.20289754  17.45909013  20.68657209]
['wanted love' 'poor quality' 'looked like' 'high hopes' 'wanted like'
 'didn work' 'looks like' 'really wanted' 'felt like' 'way big' 'did work'
 'strange fit' 'sadly going' 'just okay' 'looks cheap' 'lay flat'
 'disappointed quality' 'feels cheap' 'like tent' 'excited dress'
 'glad did' 'fabric soft' 'better person' 'easy wear' 'super comfortable'
 'fit perfect' 'perfect fit' 'great fit' 'skinny jeans' 'fits great'
 'looks great' 'received compliments' 'absolutely love' 'wait wear'
 'just right' 'love love' 'highly recommend' 'true size' 'love dress'
 'fits perfectly']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_169_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}145}]:} \PY{n}{plot2}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf23\PYZus{}sw}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf23\PYZus{}sw}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf \PYZam{} stopwords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[-46.18113309 -37.2860512  -36.23934701 -27.90896706 -24.24185099
 -22.68180366 -21.25844586 -21.17137736 -19.83464956 -19.37035545
 -17.72350007 -17.57990174 -16.79285084 -16.71574845 -15.31566129
 -14.67284075 -14.40880132 -14.17441056 -14.15149482 -13.27736212
  11.48649225  11.50350149  11.8966814   11.94115261  12.21720419
  12.41381576  12.45775746  12.46985121  12.5009868   12.74842429
  12.81347263  13.14136791  13.75151701  13.7834796   15.61901639
  15.9444128   16.00208149  17.20289754  17.45909013  20.68657209]
['wanted love' 'poor quality' 'looked like' 'high hopes' 'wanted like'
 'didn work' 'looks like' 'really wanted' 'felt like' 'way big' 'did work'
 'strange fit' 'sadly going' 'just okay' 'looks cheap' 'lay flat'
 'disappointed quality' 'feels cheap' 'like tent' 'excited dress'
 'glad did' 'fabric soft' 'better person' 'easy wear' 'super comfortable'
 'fit perfect' 'perfect fit' 'great fit' 'skinny jeans' 'fits great'
 'looks great' 'received compliments' 'absolutely love' 'wait wear'
 'just right' 'love love' 'highly recommend' 'true size' 'love dress'
 'fits perfectly']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_170_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}130}]:} \PY{n}{tfidf13} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{X\PYZus{}train\PYZus{}tfidf13\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf13}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}tfidf13\PYZus{}sw} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}tfidf13\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf13}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}tfidf13\PYZus{}sw} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}tfidf13\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf13}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf13\PYZus{}sw} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf13\PYZus{}sw}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf13\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf13\PYZus{}sw}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf13\PYZus{}sw}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf13\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf13\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf13\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf13\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf13\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf13\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf13\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf13\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf13\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf13\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf13\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          
          
          \PY{n}{plot}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf13\PYZus{}sw}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf13\PYZus{}sw}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf \PYZam{} stopwords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.9035212700997354
Test Avg Precision score:  0.950951056407899
Test F1 score:  0.9419970631424376
Test ROC AUC score:  0.8543864605679844
[12.05848816 12.16095043 12.61447121 13.42765095 13.81425072 13.93160812
 14.03745156 14.41426652 14.79590002 15.56441722 15.57226103 16.22496061
 16.95067579 18.03222937 19.10086077 20.20236878 20.38469168 25.05160831
 26.09879116 30.3913551 ]
['casual', 'happy', 'comfy', 'compliments', 'fun', 'size', 'bit', 'lovely', 'fits', 'amazing', 'beautiful', 'gorgeous', 'nice', 'soft', 'unique', 'comfortable', 'little', 'great', 'perfect', 'love']
[-35.07239766 -24.43958457 -24.20977962 -23.57648968 -23.13928364
 -22.86799576 -20.05282738 -19.89092423 -18.2893465  -17.89409231
 -17.79872131 -17.01417623 -16.96278907 -16.46124946 -16.00636427
 -15.86844172 -14.66344062 -14.62695099 -14.51920369 -14.42157622]
['disappointed', 'wanted love', 'unflattering', 'huge', 'cheap', 'returned', 'disappointing', 'returning', 'poor', 'bad', 'return', 'unfortunately', 'strange', 'wanted', 'going', 'meh', 'awful', 'looked', 'way', 'looked like']
[-35.07239766 -24.43958457 -24.20977962 -23.57648968 -23.13928364
 -22.86799576 -20.05282738 -19.89092423 -18.2893465  -17.89409231
 -17.79872131 -17.01417623 -16.96278907 -16.46124946 -16.00636427
 -15.86844172 -14.66344062 -14.62695099 -14.51920369 -14.42157622
  12.05848816  12.16095043  12.61447121  13.42765095  13.81425072
  13.93160812  14.03745156  14.41426652  14.79590002  15.56441722
  15.57226103  16.22496061  16.95067579  18.03222937  19.10086077
  20.20236878  20.38469168  25.05160831  26.09879116  30.3913551 ]
['disappointed' 'wanted love' 'unflattering' 'huge' 'cheap' 'returned'
 'disappointing' 'returning' 'poor' 'bad' 'return' 'unfortunately'
 'strange' 'wanted' 'going' 'meh' 'awful' 'looked' 'way' 'looked like'
 'casual' 'happy' 'comfy' 'compliments' 'fun' 'size' 'bit' 'lovely' 'fits'
 'amazing' 'beautiful' 'gorgeous' 'nice' 'soft' 'unique' 'comfortable'
 'little' 'great' 'perfect' 'love']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_171_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}146}]:} \PY{n}{plot2}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf13\PYZus{}sw}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf13\PYZus{}sw}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf \PYZam{} stopwords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[-24.43958457 -14.42157622 -11.49482339 -10.80945325 -10.38391307
  -9.5719569   -9.2460921   -8.45323035  -7.90508495  -7.53092583
  -7.31302445  -6.62910219  -6.52847423  -6.04965721  -5.94973235
  -5.87872434  -5.80629848  -5.66728998  -5.58763017  -5.56896563
   4.81270877   4.83722476   4.89190076   4.90371438   5.18269343
   5.34201402   5.38470411   5.40376242   5.4449024    5.61922513
   5.6628399    5.84687262   6.04975015   6.54965658   6.55472482
   6.78281017   6.80752266   6.83318307   7.32445314   8.03433286]
['wanted love' 'looked like' 'poor quality' 'really wanted' 'wanted like'
 'didn work' 'high hopes' 'did work' 'just okay' 'strange fit' 'way big'
 'pretty short' 'don think' 'looks like' 'really wanted like'
 'excited dress' 'cover cover wear' 'loved color' 'just ok'
 'wanted love dress' 'just like' 'great shirt' 'wasn sure'
 'super comfortable' 'really love' 'long arms' 'beautiful dress'
 'good quality' 'highly recommend' 'high quality' 'really nice'
 'fabric soft' 'cut flattering' 'love shirt' 'small loved' 'love dress'
 'better person' 'fits perfectly' 'just right' 'really like']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_172_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    (3,3) gives best performance

\paragraph{3.2 Running character
n-grams}\label{running-character-n-grams}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{cv} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} \PY{n}{analyzer}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{char\PYZus{}wb}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{malory}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Vocabulary size: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{cv}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Vocabulary:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{cv}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{cv} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} \PY{n}{analyzer}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{char}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{malory}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Vocabulary size: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{cv}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Vocabulary:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{cv}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}133}]:} \PY{n}{tfidf33\PYZus{}chr} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,}\PY{n}{analyzer}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{char\PYZus{}wb}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          
          \PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33\PYZus{}chr}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33\PYZus{}chr}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33\PYZus{}chr}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          
          
          \PY{n}{plot}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf \PYZam{} stopwords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8984327294931813
Test Avg Precision score:  0.9476195968337298
Test F1 score:  0.9389303634806021
Test ROC AUC score:  0.8444576748006783
[2.55712537 2.60525699 2.64089948 2.77183922 2.80021868 2.8158045
 2.85277669 2.99110441 2.9920341  3.03332472 3.06048308 3.15120968
 3.24477052 3.40246434 3.40674582 3.42982084 3.59062062 3.91414783
 4.15804706 4.91443257]
['ice', 'bit', 'iqu', 'itt', 'sof', 'un ', 'nic', ' ca', 'niq', 'rfe', ' so', ' gr', 'eat', 't! ', 'gre', 'oft', 'ove', 'erf', ' i ', 'lov']
[-4.27253072 -4.2604215  -4.18666862 -4.03839552 -3.94989989 -3.91756218
 -3.62350597 -3.56162864 -3.52295726 -3.4971716  -3.42789419 -3.41355136
 -3.41123275 -3.35153164 -3.277063   -3.21611191 -3.17979266 -3.16097599
 -2.9934303  -2.96598155]
['unf', 'eap', ' no', 'oor', 'etu', 'nfl', 'uge', 'ted', 'hea', 'not', 'was', ' wa', 'urn', 'sac', 'oin', 'nte', 'ete', 'bad', 'sap', ' un']
[-4.27253072 -4.2604215  -4.18666862 -4.03839552 -3.94989989 -3.91756218
 -3.62350597 -3.56162864 -3.52295726 -3.4971716  -3.42789419 -3.41355136
 -3.41123275 -3.35153164 -3.277063   -3.21611191 -3.17979266 -3.16097599
 -2.9934303  -2.96598155  2.55712537  2.60525699  2.64089948  2.77183922
  2.80021868  2.8158045   2.85277669  2.99110441  2.9920341   3.03332472
  3.06048308  3.15120968  3.24477052  3.40246434  3.40674582  3.42982084
  3.59062062  3.91414783  4.15804706  4.91443257]
['unf' 'eap' ' no' 'oor' 'etu' 'nfl' 'uge' 'ted' 'hea' 'not' 'was' ' wa'
 'urn' 'sac' 'oin' 'nte' 'ete' 'bad' 'sap' ' un' 'ice' 'bit' 'iqu' 'itt'
 'sof' 'un ' 'nic' ' ca' 'niq' 'rfe' ' so' ' gr' 'eat' 't! ' 'gre' 'oft'
 'ove' 'erf' ' i ' 'lov']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_176_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}134}]:} \PY{n}{tfidf33\PYZus{}chr} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,}\PY{n}{analyzer}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{char}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          
          \PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33\PYZus{}chr}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33\PYZus{}chr}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33\PYZus{}chr}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          
          
          \PY{n}{plot}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf \PYZam{} stopwords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8998575208630165
Test Avg Precision score:  0.9495930945416644
Test F1 score:  0.9398533007334964
Test ROC AUC score:  0.8483807597676127
[2.53179396 2.54387805 2.5633725  2.60092904 2.61727002 2.65238405
 2.77378936 2.90425295 2.94889685 2.96558084 3.00731959 3.05826113
 3.2130584  3.35480093 3.67987551 3.74581866 3.88473375 4.03231939
 4.31581204 5.09590356]
['rea', 'bit', 'fec', 'i l', 'iqu', ' ca', 'per', 'ice', 'niq', 'un ', ' i ', 'sof', 'rfe', 'nic', 'oft', 'ove', 'eat', 'erf', 'gre', 'lov']
[-4.79294832 -4.38634511 -4.25171691 -4.24989003 -4.16154312 -4.12123615
 -4.01792948 -3.94057573 -3.67528792 -3.63555593 -3.61485619 -3.58595399
 -3.58160198 -3.40786851 -3.17743627 -3.10763308 -3.03351723 -3.02334675
 -2.97512045 -2.97318553]
['not', 'unf', 'o l', 'eap', 'etu', 'nfl', 'oor', 'uge', 'ck.', 'was', 'hea', 'oin', 'urn', 'ted', 'sac', 'sap', 'bad', ' un', 'ete', 'nte']
[-4.79294832 -4.38634511 -4.25171691 -4.24989003 -4.16154312 -4.12123615
 -4.01792948 -3.94057573 -3.67528792 -3.63555593 -3.61485619 -3.58595399
 -3.58160198 -3.40786851 -3.17743627 -3.10763308 -3.03351723 -3.02334675
 -2.97512045 -2.97318553  2.53179396  2.54387805  2.5633725   2.60092904
  2.61727002  2.65238405  2.77378936  2.90425295  2.94889685  2.96558084
  3.00731959  3.05826113  3.2130584   3.35480093  3.67987551  3.74581866
  3.88473375  4.03231939  4.31581204  5.09590356]
['not' 'unf' 'o l' 'eap' 'etu' 'nfl' 'oor' 'uge' 'ck.' 'was' 'hea' 'oin'
 'urn' 'ted' 'sac' 'sap' 'bad' ' un' 'ete' 'nte' 'rea' 'bit' 'fec' 'i l'
 'iqu' ' ca' 'per' 'ice' 'niq' 'un ' ' i ' 'sof' 'rfe' 'nic' 'oft' 'ove'
 'eat' 'erf' 'gre' 'lov']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_177_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{3.3 Use of min-df and stop
words}\label{use-of-min-df-and-stop-words}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}341}]:} \PY{n}{feature\PYZus{}count\PYZus{}tfidf\PYZus{}cv} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{n}{test\PYZus{}scores\PYZus{}tfidf\PYZus{}cv} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{c+c1}{\PYZsh{}default params and tfidf}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{)}\PY{p}{:}
              \PY{n}{tfidf} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,}\PY{n}{analyzer}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{char}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
              \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}train} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n}{tfidf}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)} 
              \PY{n}{feature\PYZus{}count\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{)}\PY{p}{)}
              \PY{n}{logreg} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{logreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
              \PY{n}{test\PYZus{}scores\PYZus{}tfidf\PYZus{}cv}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}342}]:} \PY{n}{min\PYZus{}df}\PY{p}{(}\PY{n}{feature\PYZus{}count\PYZus{}tfidf\PYZus{}cv}\PY{p}{,}\PY{n}{test\PYZus{}scores\PYZus{}tfidf\PYZus{}cv}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tfidf with CV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_181_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_181_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \paragraph{From average precision score and roc auc we observe that
tfidf with 3,3 n grams i.e using 3 gram features alone we ge the best
results}\label{from-average-precision-score-and-roc-auc-we-observe-that-tfidf-with-33-n-grams-i.e-using-3-gram-features-alone-we-ge-the-best-results}

Also, for the best model case the number of features after using stop
words reduces from \textasciitilde{}388k to \textasciitilde{}353k which
is a 9\% reduction with a very slight drop (2\%) in average precision
score.

For the min-df case we observe that combinations of n grams are not very
likely to reappear. THus the number of features does not vary accross
different values of min-df. However, the number of features drastically
reduces from to 156k to 1.8k

    \subparagraph{Now evaluating the best performing model on the main test
set. In this case the best performing model on the basis of
average\_precision and roc\_auc is 3,3 n gram with
tfidf}\label{now-evaluating-the-best-performing-model-on-the-main-test-set.-in-this-case-the-best-performing-model-on-the-basis-of-averageux5fprecision-and-rocux5fauc-is-33-n-gram-with-tfidf}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}372}]:} \PY{n}{tfidf33} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf33\PYZus{}sw}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}sw}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8696243875884594

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}373}]:} \PY{n}{X\PYZus{}test\PYZus{}4} \PY{o}{=} \PY{n}{tfidf33}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}main\PYZus{}clean}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{text}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}374}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}4}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}4}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}4}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Test Avg Precision score:  0.9752228323332524
Test F1 score:  0.9211540707861232
Test ROC AUC score:  0.8386117344954452

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \section{Task 4}\label{task-4}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{tfidf33\PYZus{}chr} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,}\PY{n}{analyzer}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{char\PYZus{}wb}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        
        \PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33\PYZus{}chr}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{n}{y\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33\PYZus{}chr}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{feature\PYZus{}names\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33\PYZus{}chr}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
        \PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
        
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
        
        
        \PY{n}{plot}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf \PYZam{} stopwords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}197}]:} \PY{n}{top20\PYZus{}names} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{really wanted love}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wanted love dress}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{really wanted like}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{just didn work}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{just wasn flattering}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{looks great model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{looked like wearing}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wanted like dress}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{really looking forward}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wanted love wanted}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{love wanted love}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{looked like sack}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{looked like maternity}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wanted love just}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{really wanted work}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{looks like maternity}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dress looked like}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{felt like wearing}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{like maternity dress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wanted love really}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dress bought dress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{looks better person}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{small fit perfectly}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{great skinny jeans}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{runs little big}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fits like glove}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absolutely love dress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wish came colors}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{compliments time wear}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{does run large}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{size fits perfectly}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{perfect summer dress}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{love love dress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{small fits perfectly}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{looks great jeans}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fit true size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dress love dress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{runs true size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fits true size}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{love love love}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}198}]:} \PY{n}{top20\PYZus{}names}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}198}]:} ['really wanted love',
           'wanted love dress',
           'really wanted like',
           'just didn work',
           'just wasn flattering',
           'looks great model',
           'looked like wearing',
           'wanted like dress',
           'really looking forward',
           'wanted love wanted',
           'love wanted love',
           'looked like sack',
           'looked like maternity',
           'wanted love just',
           'really wanted work',
           'looks like maternity',
           'dress looked like',
           'felt like wearing',
           'like maternity dress',
           'wanted love really',
           'dress bought dress',
           'looks better person',
           'small fit perfectly',
           'great skinny jeans',
           'runs little big',
           'fits like glove',
           'absolutely love dress',
           'wish came colors',
           'compliments time wear',
           'does run large',
           'size fits perfectly',
           'perfect summer dress',
           'love love dress',
           'small fits perfectly',
           'looks great jeans',
           'fit true size',
           'dress love dress',
           'runs true size',
           'fits true size',
           'love love love']
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}199}]:} \PY{n}{voc} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{top20\PYZus{}names}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}200}]:} \PY{n}{voc}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}200}]:} 'really wanted love wanted love dress really wanted like just didn work just wasn flattering looks great model looked like wearing wanted like dress really looking forward wanted love wanted love wanted love looked like sack looked like maternity wanted love just really wanted work looks like maternity dress looked like felt like wearing like maternity dress wanted love really dress bought dress looks better person small fit perfectly great skinny jeans runs little big fits like glove absolutely love dress wish came colors compliments time wear does run large size fits perfectly perfect summer dress love love dress small fits perfectly looks great jeans fit true size dress love dress runs true size fits true size love love love'
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \subparagraph{3,3 is the best performing model. THerefore, here we train
the model on only on the top 20 features. Thus the training value will
have}\label{is-the-best-performing-model.-therefore-here-we-train-the-model-on-only-on-the-top-20-features.-thus-the-training-value-will-have}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}203}]:} \PY{n}{tfidf33\PYZus{}chr} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
          \PY{n}{tfidf33\PYZus{}chr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{top20\PYZus{}names}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}203}]:} TfidfVectorizer(analyzer='word', binary=False, decode\_error='strict',
                  dtype=<class 'numpy.int64'>, encoding='utf-8', input='content',
                  lowercase=True, max\_df=1.0, max\_features=None, min\_df=1,
                  ngram\_range=(3, 3), norm='l2', preprocessor=None, smooth\_idf=True,
                  stop\_words='english', strip\_accents=None, sublinear\_tf=False,
                  token\_pattern='(?u)\textbackslash{}\textbackslash{}b\textbackslash{}\textbackslash{}w\textbackslash{}\textbackslash{}w+\textbackslash{}\textbackslash{}b', tokenizer=None, use\_idf=True,
                  vocabulary=None)
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}204}]:} \PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33\PYZus{}chr}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33\PYZus{}chr}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33\PYZus{}chr}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} \PY{o}{=} \PY{n}{LogisticRegressionCV}\PY{p}{(}\PY{n}{scoring} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average\PYZus{}precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}print(\PYZdq{}Test ROC AUC score: \PYZdq{}, roc\PYZus{}auc\PYZus{}score(logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw.predict(X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw),y\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw))}
          
          
          \PY{n}{plot}\PY{p}{(}\PY{n}{logreg\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}names\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf \PYZam{} stopwords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
test score: 0.8255648280073274
Test Avg Precision score:  0.9923656786600952
Test F1 score:  0.9030213873486477
[0.62978991 0.8681424  1.43005756 1.70062776 1.98760741 2.07432436
 2.08773766 2.22089793 2.82117228 3.43250548 3.60999337 3.61651236
 3.62434087 3.64092872 3.65729999 3.72658233 3.91197097 4.02150967
 4.25037578 4.49548995]
['fit true size', 'does run large', 'small fit perfectly', 'fits true size', 'size fits perfectly', 'looks great jeans', 'fits like glove', 'runs true size', 'love love love', 'love love dress', 'absolutely love dress', 'runs little big', 'wish came colors', 'looks better person', 'compliments time wear', 'great skinny jeans', 'small fits perfectly', 'perfect summer dress', 'dress love dress', 'dress bought dress']
[-5.13277821 -3.26080294 -3.18066545 -3.13737648 -3.12430067 -3.05663908
 -3.0099685  -2.49133229 -2.4844754  -2.43253141 -2.42604465 -2.37218787
 -2.06802344 -2.06324777 -1.97851051 -1.96235476 -1.8126975  -1.743979
 -1.50967487  0.09343865]
['looks great model', 'wanted love wanted', 'dress looked like', 'looked like wearing', 'really wanted like', 'looked like maternity', 'looked like sack', 'looks like maternity', 'really looking forward', 'wanted love just', 'just wasn flattering', 'really wanted love', 'like maternity dress', 'wanted like dress', 'wanted love really', 'wanted love dress', 'really wanted work', 'just didn work', 'felt like wearing', 'love wanted love']
[-5.13277821 -3.26080294 -3.18066545 -3.13737648 -3.12430067 -3.05663908
 -3.0099685  -2.49133229 -2.4844754  -2.43253141 -2.42604465 -2.37218787
 -2.06802344 -2.06324777 -1.97851051 -1.96235476 -1.8126975  -1.743979
 -1.50967487  0.09343865  0.62978991  0.8681424   1.43005756  1.70062776
  1.98760741  2.07432436  2.08773766  2.22089793  2.82117228  3.43250548
  3.60999337  3.61651236  3.62434087  3.64092872  3.65729999  3.72658233
  3.91197097  4.02150967  4.25037578  4.49548995]
['looks great model' 'wanted love wanted' 'dress looked like'
 'looked like wearing' 'really wanted like' 'looked like maternity'
 'looked like sack' 'looks like maternity' 'really looking forward'
 'wanted love just' 'just wasn flattering' 'really wanted love'
 'like maternity dress' 'wanted like dress' 'wanted love really'
 'wanted love dress' 'really wanted work' 'just didn work'
 'felt like wearing' 'love wanted love' 'fit true size' 'does run large'
 'small fit perfectly' 'fits true size' 'size fits perfectly'
 'looks great jeans' 'fits like glove' 'runs true size' 'love love love'
 'love love dress' 'absolutely love dress' 'runs little big'
 'wish came colors' 'looks better person' 'compliments time wear'
 'great skinny jeans' 'small fits perfectly' 'perfect summer dress'
 'dress love dress' 'dress bought dress']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_205_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}205}]:} \PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw} 
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}205}]:} <14762x40 sparse matrix of type '<class 'numpy.float64'>'
          	with 1676 stored elements in Compressed Sparse Row format>
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}166}]:} \PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}chr\PYZus{}sw}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}166}]:} <4913x1 sparse matrix of type '<class 'numpy.float64'>'
          	with 0 stored elements in Compressed Sparse Row format>
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    Now we train the tfidf with stop words and n\_grams = (3,3) model on an
svm with l1 and l2 penalties

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}356}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{svm} \PY{k}{import} \PY{n}{LinearSVC}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{GridSearchCV}
          
          \PY{n}{svcl1} \PY{o}{=} \PY{n}{LinearSVC}\PY{p}{(}\PY{n}{penalty}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{dual} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
          \PY{n}{svcl2} \PY{o}{=} \PY{n}{LinearSVC}\PY{p}{(}\PY{n}{penalty}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{parameters} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{\PYZcb{}}
          \PY{n}{clf1} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{svcl1}\PY{p}{,} \PY{n}{parameters}\PY{p}{)}
          \PY{n}{clf2} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{svcl2}\PY{p}{,} \PY{n}{parameters}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}357}]:} \PY{n}{tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33\PYZus{}sw}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}train\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{train3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33\PYZus{}sw}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{test3\PYZus{}clean}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recommended}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}names\PYZus{}tfidf33\PYZus{}sw} \PY{o}{=} \PY{n}{tfidf33\PYZus{}sw}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          
          
          \PY{c+c1}{\PYZsh{}svm\PYZus{}tfidf33\PYZus{}sw = LogisticRegressionCV(scoring = \PYZsq{}average\PYZus{}precision\PYZsq{})}
          \PY{n}{clf1}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}
          \PY{n}{clf2}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfidf33\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}
          
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1 test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{clf1}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{l1 Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{clf1}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{l1 Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{clf1}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{l1 Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{clf1}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          
          
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l2 test score:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{clf2}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{l2 Test Avg Precision score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{clf2}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{l2 Test F1 score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{clf2}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{l2 Test ROC AUC score: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{clf2}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}tfidf33\PYZus{}sw}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
l1 test score: 0.8214480130647795
l1 Test Avg Precision score:  0.9739109331248541
l1 Test F1 score:  0.8994481912936848
l1 Test ROC AUC score:  0.691152803069538
l2 test score: 0.8255307566684812
l2 Test Avg Precision score:  0.9875369314309514
l2 Test F1 score:  0.9026871109761652
l2 Test ROC AUC score:  0.7480933779761906

    \end{Verbatim}

    \subparagraph{We see that using svc with l1 and l2 penalties leads to a
significant drop in
performance.}\label{we-see-that-using-svc-with-l1-and-l2-penalties-leads-to-a-significant-drop-in-performance.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}

    We could explore: -Length of text

\begin{verbatim}
-Presence of Emojis

-Number of out-of-vocabularly words

-Presence / frequency of ALL CAPS

-Presence of punctuation like !

-Sentiment words (fantastic, great, amazing vs disappointing, bad, etc.)
\end{verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
